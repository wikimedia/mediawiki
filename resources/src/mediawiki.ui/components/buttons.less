@import "mediawiki.mixins";
@import "mediawiki.ui/variables";
@import "mediawiki.ui/mixins";

/*
Buttons

<h3>Guidelines:</h3>

- .mw-ui-button can **only** be used on **A, INPUT, and BUTTON tags**. There is support for some input types, but this doesn't work in older browsers.
- .mw-ui-progressive, .mw-ui-regressive, .mw-ui-constructive, and .mw-ui-destructive can be applied alone on A, but can be applied in tandem with .mw-ui-button. *The class order is important:* **base type** (mw-ui-button) must come **first**, **mode** (mw-ui-quiet, mw-ui-sleeper) **second**, **visual type** (mw-ui-thin) **third**, and **context** (mw-ui-progressive) comes **last**.
- .mw-ui-progressive, .mw-ui-constructive, and .mw-ui-destructive can be applied alone on A (see Styleguide 4.0), but can be applied in tandem with .mw-ui-button. *The class order is important:* **base type** (mw-ui-button) must come **first**, **mode** (mw-ui-quiet, mw-ui-sleeper) **second**, and **context** (mw-ui-progressive) comes **last**.
- A .mw-ui-quiet button may **never** be the first or only button in a form.
- Semantically, the **first button in a form should always be the affirmative action** (eg. Submit). This is for accessibility purposes. Where it appears visually is not as important.

<h3>Notes:</h3>

- IE6 does not apply any .mw-ui-button styles at all on BUTTON.
- IE6 only applies the base .mw-ui-CONTEXT color on A, and doesn't care if you are combining it (ie. .mw-ui-destructive.mw-ui-quiet = always red text).
- IE7 and IE8 look slightly different from other browsers when rendering certain modes of these buttons.

Markup:
<button class="mw-ui-button {$modifiers}">Default</button>
<button class="mw-ui-button mw-ui-progressive {$modifiers}">Progressive</button>
<button class="mw-ui-button mw-ui-constructive {$modifiers}">Constructive</button>
<button class="mw-ui-button mw-ui-destructive {$modifiers}">Destructive</button>
<button class="mw-ui-button mw-ui-progressive {$modifiers}" disabled>Disabled Progressive</button>

.mw-ui-quiet - Quiet: A button that doesn't look like a button.
.mw-ui-sleeper - Sleeper: A button which always looks like a button, but uncolored until interaction.
.mw-ui-thin - Thin: A smaller button (less padding) which also inherits font weight.
.mw-ui-inline - Inline: An even smaller button (zero padding) which also inherits font weight.
.mw-ui-big - Big: 1.3x font-size.

Styleguide 2.
*/

// Helpers
// Individual Button Contexts
.mixin-mw-ui-button-context( @contextualColor ) {
	@textShadowColor: spin( @colorTextLight, 180 );
	@borderColor: mix( @contextualColor, #000, 75% );
	@raisedColor: mix( @contextualColor, #fff, 92% );
	@depressedColor: darken( @contextualColor, 8% );
	@quietDepressedColor: darken( @contextualColor, 25% );

	.mixin-mw-ui-button-disabled-state() {
		&[disabled],
		&[disabled]:hover,
		&[disabled]:focus,
		&.mw-ui-thin[disabled]:hover {
			background: @colorGrayLight;
			color: @colorWhite;
			text-shadow: none;
			.box-shadow( ~"none" );
		}
	}

	.mixin-mw-ui-button-normal-mode() {
		background: @contextualColor;
		color: @colorWhite;
		text-shadow: 0 1px fade( @textShadowColor, 10% );

		.mixin-mw-ui-button-disabled-state();

		&:hover,
		&:focus {
			background: @raisedColor;
			text-shadow: 0 1px fade( @textShadowColor, 33% );
		}

		&:hover {
			// Shadow under outer, 3D raising inner, edge shading inner
			.box-shadow( ~"0 1px 0 0 rgba(0, 0, 0, .15), inset 0 -4px 0 0 @{borderColor}, inset 0 -1px 1px 0 rgba(0, 0, 0, .05)" );
		}
		&.mw-ui-thin:hover {
			// Shadow under outer, 3D raising inner, edge shading inner
			.box-shadow( ~"0 1px 0 0 rgba(0, 0, 0, .15), inset 0 -3px 0 0 @{borderColor}, inset 0 -1px 1px 0 rgba(0, 0, 0, .05)" );
		}

		&:focus {
			// 3D raising inner, edge shading inner
			.box-shadow( ~"inset 0 -4px 0 0 @{borderColor}, inset 0 -1px 1px 0 rgba(0, 0, 0, .05), inset 0 0 0 1px @{borderColor}" );
		}

		&:active {
			background: @depressedColor;
			// Slight 3D raising inner, deep edge shading inner
			.box-shadow( ~"inset 0 -2px 0 0 @{depressedColor}, inset 0 2px 0 0 rgba(0, 0, 0, .25)" );
		}
	}

	// Default mode (fully colored)
	&:not(.mw-ui-quiet) {
		.mixin-mw-ui-button-normal-mode();
	}
	.lte-ie8 & { // IE7 & IE8 do not support :not() selector
		.mixin-mw-ui-button-normal-mode();
	}

	// Quiet mode (transparent bg, no border; text color on activity)
	.lte-ie8 &.mw-ui-quiet,
	&.mw-ui-quiet {
		background: transparent;
		color: @colorTextLight;

		&:hover {
			color: @contextualColor;
		}

		&:active {
			color: @depressedColor;
		}

		&:focus {
			color: @quietDepressedColor;
		}

		.mixin-mw-ui-button-disabled-state();
	}

	// Sleeper mode (transparent bg, no border; bg on activity)
	&.mw-ui-sleeper {
		background: transparent;
		background: ~"@{colorGrayLightest}\9"; //IE7-IE8 hack; they don't have box-shadow
		color: mix( @contextualColor, @colorTextLight, 20%);
		text-shadow: none;
		.box-shadow( ~"inset 0 0 0 1px @{colorGrayLighter}" );

		&:hover,
		&:focus {
			color: @colorWhite;
		}
	}
}

// Default button styles
.mixin-mw-ui-button-default() {
	background: @colorGrayLightest;
	color: @colorTextLight;
	@textShadowColor: spin( @colorTextLight, 180 );
	@borderColor: mix( @colorGrayLightest, #000, 75% );
	@raisedColor: mix( @colorGrayLightest, #fff, 92% );
	@depressedColor: darken( @colorGrayLightest, 8% );
	@quietDepressedColor: darken( @colorGrayLightest, 25% );

	.mixin-mw-ui-button-normal-mode() {
		&:hover,
		&:focus {
			background: @raisedColor;
			text-shadow: 0 1px fade( @textShadowColor, 33% );
		}

		&:hover {
			// Shadow under outer, 3D raising inner, edge shading inner
			.box-shadow( ~"0 1px 0 0 rgba(0, 0, 0, .15), inset 0 -4px 0 0 @{borderColor}, inset 0 -1px 1px 0 rgba(0, 0, 0, .05)" );
		}

		&:focus {
			// 3D raising inner, edge shading inner
			.box-shadow( ~"inset 0 -4px 0 0 @{borderColor}, inset 0 -1px 1px 0 rgba(0, 0, 0, .05), inset 0 0 0 1px @{borderColor}" );
		}

		&:active {
			background: @depressedColor;
			// Slight 3D raising inner, deep edge shading inner
			.box-shadow( ~"inset 0 -2px 0 0 @{depressedColor}, inset 0 2px 0 0 rgba(0, 0, 0, .25)" );
		}
	}

	// Default mode (fully colored)
	&:not(.mw-ui-quiet) {
		.mixin-mw-ui-button-normal-mode();
	}
	.lte-ie8 & { // IE7 & IE8 do not support :not() selector
		.mixin-mw-ui-button-normal-mode();
	}

	// Quiet mode (transparent bg, no border; text color on activity)
	.lte-ie8 &.mw-ui-quiet,
	&.mw-ui-quiet {
		background: transparent;

		&:hover,
		&:focus,
		&:active {
			color: @colorText;
		}
	}

	// Sleeper mode (transparent bg, no border; bg on activity)
	.lte-ie8 &.mw-ui-sleeper,
	&.mw-ui-sleeper {
		background: transparent;
		// Fake border around
		.box-shadow( ~"inset 0 0 0 1px @{colorGrayLighter}" );

		&:hover {
			background: @colorOffWhite;
			// Fake border around, shadow under outer, 3D raising inner, edge shading inner
			.box-shadow( ~"inset 0 0 0 1px @{colorGrayLighter}, 0 1px 0 0 rgba(0, 0, 0, .15), inset0 -3px 0 0 @{colorGrayLighter}, inset 0 -1px 1px 0 rgba(0, 0, 0, .05)" );
		}
		&.mw-ui-thin:hover {
			// Fake border around, shadow under outer, 3D raising inner, edge shading inner
			.box-shadow( ~"inset 0 0 0 1px @{colorGrayLighter}, 0 1px 0 0 rgba(0, 0, 0, .15), inset 0 -2px 0 0 @{colorGrayLighter}, inset 0 -1px 1px 0 rgba(0, 0, 0, .05)" );
		}
	}
}

// Selector mixins, used for customization if needed
.mixin-mw-ui-button() {
	// Container layout
	display: inline-block;
	padding: .5em 1em;
	margin: 0;
	vertical-align: middle;
	.box-sizing(border-box);

	// IE6/IE7 hack
	*display: inline;
	zoom: 1;

	// Disable weird iOS styling
	-webkit-appearance: none;

	// Typography
	font-family: inherit;
	font-size: 1em;
	font-weight: bold;
	line-height: inherit;
	text-decoration: none;

	// Design
	border: 0px solid transparent;
	border-radius: 3px;
	cursor: pointer;

	// Animation
	.transition( ~"box-shadow .1s linear, background-color .1s linear, opacity .5s linear" );

	// Disabled state (cursor fix)
	&:disabled {
		cursor: default;
	}
	// Focus/active state (outline fix)
	&:focus, &:active {
		outline: none;
	}

	/*
	 * Button modes (continued in .mw-ui-button-context())
	 */

	// Thin mode (reduced visual weight)
	&.mw-ui-thin {
		padding: .25em .5em;
		font-weight: inherit;
		vertical-align: inherit;
	}

	// Inline mode (no padding)
	&.mw-ui-inline {
		padding: 0;
		font-weight: inherit;
		vertical-align: inherit;
	}

	// Big mode (1.3x font size)
	&.mw-ui-big {
		font-size: 1.3em;
	}

	/*
	 * Default button styles
	 */

	.mixin-mw-ui-button-default();

	/*
	 * Contextual classes
	 */

	// Progressive context
	&.mw-ui-progressive {
		.mixin-mw-ui-button-context( @colorProgressive );
	}

	// Constructive context
	&.mw-ui-constructive {
		.mixin-mw-ui-button-context( @colorConstructive );
	}

	// Destructive context
	&.mw-ui-destructive {
		.mixin-mw-ui-button-context( @colorDestructive );
	}
}

// Button selectors
.mw-ui-button {
	.mixin-mw-ui-button;

	// Default mw-ui-button implementation forces min dimensions for improved touch access
	min-width: 48px;
	min-height: 33px;

	// When these buttons are children of mw-ui-button-group, adjust accordingly
	.mw-ui-button-group > & {
		.mw-ui-button-group-child;
	}
}

/*
Button groups

Group of buttons.

Markup:
<div class="mw-ui-button-group">
  <a class="mw-ui-button" href=javascript:void(0)>A</a>
  <a class="mw-ui-button" href=javascript:void(0)>B</a>
  <a class="mw-ui-button" href=javascript:void(0)>C</a>
  <a class="mw-ui-button" href=javascript:void(0)>D</a>
</div>

Styleguide 2.1.
*/
.mw-ui-button-group {
	// Clearfix
	zoom: 1;
	&:after {
		content: "";
		display: table;
		clear: both;
	}
}

// To be used within .mw-ui-button selector
.mw-ui-button-group-child() {
	border-radius: 0;
	float: left;

	&:first-child {
		border-top-left-radius: 3px;
		border-bottom-left-radius: 3px;
	}

	&:last-child {
		border-top-right-radius: 3px;
		border-bottom-right-radius: 3px;
	}
}
