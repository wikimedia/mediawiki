(function(OO){'use strict';OO.ui={};OO.ui.bind=$.proxy;OO.ui.Keys={UNDEFINED:0,BACKSPACE:8,DELETE:46,LEFT:37,RIGHT:39,UP:38,DOWN:40,ENTER:13,END:35,HOME:36,TAB:9,PAGEUP:33,PAGEDOWN:34,ESCAPE:27,SHIFT:16,SPACE:32};OO.ui.MouseButtons={LEFT:1,MIDDLE:2,RIGHT:3};OO.ui.elementId=0;OO.ui.generateElementId=function(){OO.ui.elementId++;return'ooui-'+OO.ui.elementId};OO.ui.isFocusableElement=function($element){var nodeName,element=$element[0];if(element.disabled){return!1}
if(!($.expr.pseudos.visible(element)&&!$element.parents().addBack().filter(function(){return $.css(this,'visibility')==='hidden'}).length)){return!1}
if(element.contentEditable==='true'){return!0}
if($element.prop('tabIndex')>=0){return!0}
nodeName=element.nodeName.toLowerCase();if(['input','select','textarea','button','object'].indexOf(nodeName)!==-1){return!0}
if((nodeName==='a'||nodeName==='area')&&$element.attr('href')!==undefined){return!0}
return!1};OO.ui.findFocusable=function($container,backwards){var $focusable=$([]),$focusableCandidates=$container.find('input, select, textarea, button, object, a, area, [contenteditable], [tabindex]');if(backwards){$focusableCandidates=Array.prototype.reverse.call($focusableCandidates)}
$focusableCandidates.each(function(){var $this=$(this);if(OO.ui.isFocusableElement($this)){$focusable=$this;return!1}});return $focusable};OO.ui.getUserLanguages=function(){return['en']};OO.ui.getLocalValue=function(obj,lang,fallback){var i,len,langs;if(obj[lang]){return obj[lang]}
langs=OO.ui.getUserLanguages();for(i=0,len=langs.length;i<len;i++){lang=langs[i];if(obj[lang]){return obj[lang]}}
if(obj[fallback]){return obj[fallback]}
for(lang in obj){return obj[lang]}
return undefined};OO.ui.contains=function(containers,contained,matchContainers){var i;if(!Array.isArray(containers)){containers=[containers]}
for(i=containers.length-1;i>=0;i--){if((matchContainers&&contained===containers[i])||$.contains(containers[i],contained)){return!0}}
return!1};OO.ui.debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null;if(!immediate){func.apply(context,args)}};if(immediate&&!timeout){func.apply(context,args)}
if(!timeout||wait){clearTimeout(timeout);timeout=setTimeout(later,wait)}}};OO.ui.warnDeprecation=function(message){if(OO.getProp(window,'console','warn')!==undefined){console.warn(message)}};OO.ui.throttle=function(func,wait){var context,args,timeout,previous=0,run=function(){timeout=null;previous=OO.ui.now();func.apply(context,args)};return function(){var remaining=wait-(OO.ui.now()-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);run()}else if(!timeout){timeout=setTimeout(run,remaining)}}};OO.ui.now=Date.now||function(){return new Date().getTime()};OO.ui.infuse=function(idOrNode){return OO.ui.Element.static.infuse(idOrNode)};(function(){var messages={'ooui-outline-control-move-down':'Move item down','ooui-outline-control-move-up':'Move item up','ooui-outline-control-remove':'Remove item','ooui-toolbar-more':'More','ooui-toolgroup-expand':'More','ooui-toolgroup-collapse':'Fewer','ooui-item-remove':'Remove','ooui-dialog-message-accept':'OK','ooui-dialog-message-reject':'Cancel','ooui-dialog-process-error':'Something went wrong','ooui-dialog-process-dismiss':'Dismiss','ooui-dialog-process-retry':'Try again','ooui-dialog-process-continue':'Continue','ooui-selectfile-button-select':'Select a file','ooui-selectfile-not-supported':'File selection is not supported','ooui-selectfile-placeholder':'No file is selected','ooui-selectfile-dragdrop-placeholder':'Drop file here'};OO.ui.msg=function(key){var message=messages[key],params=Array.prototype.slice.call(arguments,1);if(typeof message==='string'){message=message.replace(/\$(\d+)/g,function(unused,n){var i=parseInt(n,10);return params[i-1]!==undefined?params[i-1]:'$'+n})}else{message='['+key+']'}
return message}}());OO.ui.deferMsg=function(){var args=arguments;return function(){return OO.ui.msg.apply(OO.ui,args)}};OO.ui.resolveMsg=function(msg){if($.isFunction(msg)){return msg()}
return msg};OO.ui.isSafeUrl=function(url){var i,protocolWhitelist;function stringStartsWith(haystack,needle){return haystack.substr(0,needle.length)===needle}
protocolWhitelist=['bitcoin','ftp','ftps','geo','git','gopher','http','https','irc','ircs','magnet','mailto','mms','news','nntp','redis','sftp','sip','sips','sms','ssh','svn','tel','telnet','urn','worldwind','xmpp'];if(url===''){return!0}
for(i=0;i<protocolWhitelist.length;i++){if(stringStartsWith(url,protocolWhitelist[i]+':')){return!0}}
if(stringStartsWith(url,'/')||stringStartsWith(url,'./')){return!0}
if(stringStartsWith(url,'?')||stringStartsWith(url,'#')){return!0}
return!1};OO.ui.isMobile=function(){return!1};OO.ui.getViewportSpacing=function(){return{top:0,right:0,bottom:0,left:0}};OO.ui.getDefaultOverlay=function(){if(!OO.ui.$defaultOverlay){OO.ui.$defaultOverlay=$('<div>').addClass('oo-ui-defaultOverlay');$('body').append(OO.ui.$defaultOverlay)}
return OO.ui.$defaultOverlay};OO.ui.mixin={};OO.ui.Element=function OoUiElement(config){if(OO.ui.isDemo){this.initialConfig=config}
config=config||{};this.$=$;this.elementId=null;this.visible=!0;this.data=config.data;this.$element=config.$element||$(document.createElement(this.getTagName()));this.elementGroup=null;if(Array.isArray(config.classes)){this.$element.addClass(config.classes.join(' '))}
if(config.id){this.setElementId(config.id)}
if(config.text){this.$element.text(config.text)}
if(config.content){this.$element.append(config.content.map(function(v){if(typeof v==='string'){return document.createTextNode(v)}else if(v instanceof OO.ui.HtmlSnippet){return v.toString()}else if(v instanceof OO.ui.Element){return v.$element}
return v}))}
if(config.$content){this.$element.append(config.$content)}};OO.initClass(OO.ui.Element);OO.ui.Element.static.tagName='div';OO.ui.Element.static.infuse=function(idOrNode){var obj=OO.ui.Element.static.unsafeInfuse(idOrNode,!1);return obj};OO.ui.Element.static.unsafeInfuse=function(idOrNode,domPromise){var id,$elem,error,data,cls,parts,parent,obj,top,state,infusedChildren;if(typeof idOrNode==='string'){id=idOrNode;$elem=$(document.getElementById(id))}else{$elem=$(idOrNode);id=$elem.attr('id')}
if(!$elem.length){if(typeof idOrNode==='string'){error='Widget not found: '+idOrNode}else if(idOrNode&&idOrNode.selector){error='Widget not found: '+idOrNode.selector}else{error='Widget not found'}
throw new Error(error)}
if($elem[0].oouiInfused){$elem=$elem[0].oouiInfused}
data=$elem.data('ooui-infused');if(data){if(data===!0){throw new Error('Circular dependency! '+id)}
if(domPromise){state=data.constructor.static.gatherPreInfuseState($elem,data);domPromise.done(data.restorePreInfuseState.bind(data,state));infusedChildren=$elem.data('ooui-infused-children');if(infusedChildren&&infusedChildren.length){infusedChildren.forEach(function(data){var state=data.constructor.static.gatherPreInfuseState($elem,data);domPromise.done(data.restorePreInfuseState.bind(data,state))})}}
return data}
data=$elem.attr('data-ooui');if(!data){throw new Error('No infusion data found: '+id)}
try{data=JSON.parse(data)}catch(_){data=null}
if(!(data&&data._)){throw new Error('No valid infusion data found: '+id)}
if(data._==='Tag'){return new OO.ui.Element({$element:$elem})}
parts=data._.split('.');cls=OO.getProp.apply(OO,[window].concat(parts));if(cls===undefined){throw new Error('Unknown widget type: id: '+id+', class: '+data._)}
parent=cls.parent;while(parent!==undefined){if(parent===OO.ui.Element){break}
parent=parent.parent}
if(parent!==OO.ui.Element){throw new Error('Unknown widget type: id: '+id+', class: '+data._)}
if(domPromise===!1){top=$.Deferred();domPromise=top.promise()}
$elem.data('ooui-infused',!0);data.id=id;infusedChildren=[];data=OO.copy(data,null,function deserialize(value){var infused;if(OO.isPlainObject(value)){if(value.tag){infused=OO.ui.Element.static.unsafeInfuse(value.tag,domPromise);infusedChildren.push(infused);infusedChildren.push.apply(infusedChildren,infused.$element.data('ooui-infused-children')||[]);infused.$element.removeData('ooui-infused-children');return infused}
if(value.html!==undefined){return new OO.ui.HtmlSnippet(value.html)}}});data=cls.static.reusePreInfuseDOM($elem[0],data);state=cls.static.gatherPreInfuseState($elem[0],data);obj=new cls(data);$elem[0].oouiInfused=obj.$element;if(top){if($elem[0]!==obj.$element[0]){$elem.replaceWith(obj.$element)}
top.resolve()}
obj.$element.data('ooui-infused',obj);obj.$element.data('ooui-infused-children',infusedChildren);obj.$element.attr('data-ooui','');domPromise.done(obj.restorePreInfuseState.bind(obj,state));return obj};OO.ui.Element.static.reusePreInfuseDOM=function(node,config){return config};OO.ui.Element.static.gatherPreInfuseState=function(){return{}};OO.ui.Element.static.getJQuery=function(context,$iframe){function wrapper(selector){return $(selector,wrapper.context)}
wrapper.context=this.getDocument(context);if($iframe){wrapper.$iframe=$iframe}
return wrapper};OO.ui.Element.static.getDocument=function(obj){return(obj[0]&&obj[0].ownerDocument)||obj.context||obj.ownerDocument||obj.document||(obj.nodeType===Node.DOCUMENT_NODE&&obj)||null};OO.ui.Element.static.getWindow=function(obj){var doc=this.getDocument(obj);return doc.defaultView};OO.ui.Element.static.getDir=function(obj){var isDoc,isWin;if(obj instanceof jQuery){obj=obj[0]}
isDoc=obj.nodeType===Node.DOCUMENT_NODE;isWin=obj.document!==undefined;if(isDoc||isWin){if(isWin){obj=obj.document}
obj=obj.body}
return $(obj).css('direction')};OO.ui.Element.static.getFrameOffset=function(from,to,offset){var i,len,frames,frame,rect;if(!to){to=window}
if(!offset){offset={top:0,left:0}}
if(from.parent===from){return offset}
frames=from.parent.document.getElementsByTagName('iframe');for(i=0,len=frames.length;i<len;i++){if(frames[i].contentWindow===from){frame=frames[i];break}}
if(frame){rect=frame.getBoundingClientRect();offset.left+=rect.left;offset.top+=rect.top;if(from!==to){this.getFrameOffset(from.parent,offset)}}
return offset};OO.ui.Element.static.getRelativePosition=function($element,$anchor){var iframe,iframePos,pos=$element.offset(),anchorPos=$anchor.offset(),elementDocument=this.getDocument($element),anchorDocument=this.getDocument($anchor);while(elementDocument!==anchorDocument){iframe=elementDocument.defaultView.frameElement;if(!iframe){throw new Error('$element frame is not contained in $anchor frame')}
iframePos=$(iframe).offset();pos.left+=iframePos.left;pos.top+=iframePos.top;elementDocument=iframe.ownerDocument}
pos.left-=anchorPos.left;pos.top-=anchorPos.top;return pos};OO.ui.Element.static.getBorders=function(el){var doc=el.ownerDocument,win=doc.defaultView,style=win.getComputedStyle(el,null),$el=$(el),top=parseFloat(style?style.borderTopWidth:$el.css('borderTopWidth'))||0,left=parseFloat(style?style.borderLeftWidth:$el.css('borderLeftWidth'))||0,bottom=parseFloat(style?style.borderBottomWidth:$el.css('borderBottomWidth'))||0,right=parseFloat(style?style.borderRightWidth:$el.css('borderRightWidth'))||0;return{top:top,left:left,bottom:bottom,right:right}};OO.ui.Element.static.getDimensions=function(el){var $el,$win,doc=el.ownerDocument||el.document,win=doc.defaultView;if(win===el||el===doc.documentElement){$win=$(win);return{borders:{top:0,left:0,bottom:0,right:0},scroll:{top:$win.scrollTop(),left:$win.scrollLeft()},scrollbar:{right:0,bottom:0},rect:{top:0,left:0,bottom:$win.innerHeight(),right:$win.innerWidth()}}}else{$el=$(el);return{borders:this.getBorders(el),scroll:{top:$el.scrollTop(),left:$el.scrollLeft()},scrollbar:{right:$el.innerWidth()-el.clientWidth,bottom:$el.innerHeight()-el.clientHeight},rect:el.getBoundingClientRect()}}};OO.ui.Element.static.getScrollLeft=(function(){var rtlScrollType=null;function test(){var $definer=$('<div dir="rtl" style="font-size: 14px; width: 1px; height: 1px; position: absolute; top: -1000px; overflow: scroll">A</div>'),definer=$definer[0];$definer.appendTo('body');if(definer.scrollLeft>0){rtlScrollType='default'}else{definer.scrollLeft=1;if(definer.scrollLeft===0){rtlScrollType='negative'}else{rtlScrollType='reverse'}}
$definer.remove()}
return function getScrollLeft(el){var isRoot=el.window===el||el===el.ownerDocument.body||el===el.ownerDocument.documentElement,scrollLeft=isRoot?$(window).scrollLeft():el.scrollLeft,direction=isRoot?'ltr':$(el).css('direction');if(direction==='rtl'){if(rtlScrollType===null){test()}
if(rtlScrollType==='reverse'){scrollLeft=-scrollLeft}else if(rtlScrollType==='default'){scrollLeft=scrollLeft-el.scrollWidth+el.clientWidth}}
return scrollLeft}}());OO.ui.Element.static.getRootScrollableElement=function(el){var scrollTop,body;if(OO.ui.scrollableElement===undefined){body=el.ownerDocument.body;scrollTop=body.scrollTop;body.scrollTop=1;if(Math.round(body.scrollTop)===1){body.scrollTop=scrollTop;OO.ui.scrollableElement='body'}else{OO.ui.scrollableElement='documentElement'}}
return el.ownerDocument[OO.ui.scrollableElement]};OO.ui.Element.static.getClosestScrollableContainer=function(el,dimension){var i,val,props=['overflow-x','overflow-y'],$parent=$(el).parent();if(dimension==='x'||dimension==='y'){props=['overflow-'+dimension]}
if($(el).is('html, body')){return this.getRootScrollableElement(el)}
while($parent.length){if($parent[0]===this.getRootScrollableElement(el)){return $parent[0]}
i=props.length;while(i--){val=$parent.css(props[i]);if(val==='auto'||val==='scroll'){return $parent[0]}}
$parent=$parent.parent()}
return this.getRootScrollableElement(el)};OO.ui.Element.static.scrollIntoView=function(el,config){var position,animations,container,$container,elementDimensions,containerDimensions,$window,deferred=$.Deferred();config=config||{};animations={};container=this.getClosestScrollableContainer(el,config.direction);$container=$(container);elementDimensions=this.getDimensions(el);containerDimensions=this.getDimensions(container);$window=$(this.getWindow(el));if($container.is('html, body')){position={top:elementDimensions.rect.top,bottom:$window.innerHeight()-elementDimensions.rect.bottom,left:elementDimensions.rect.left,right:$window.innerWidth()-elementDimensions.rect.right}}else{position={top:elementDimensions.rect.top-(containerDimensions.rect.top+containerDimensions.borders.top),bottom:containerDimensions.rect.bottom-containerDimensions.borders.bottom-containerDimensions.scrollbar.bottom-elementDimensions.rect.bottom,left:elementDimensions.rect.left-(containerDimensions.rect.left+containerDimensions.borders.left),right:containerDimensions.rect.right-containerDimensions.borders.right-containerDimensions.scrollbar.right-elementDimensions.rect.right}}
if(!config.direction||config.direction==='y'){if(position.top<0){animations.scrollTop=containerDimensions.scroll.top+position.top}else if(position.top>0&&position.bottom<0){animations.scrollTop=containerDimensions.scroll.top+Math.min(position.top,-position.bottom)}}
if(!config.direction||config.direction==='x'){if(position.left<0){animations.scrollLeft=containerDimensions.scroll.left+position.left}else if(position.left>0&&position.right<0){animations.scrollLeft=containerDimensions.scroll.left+Math.min(position.left,-position.right)}}
if(!$.isEmptyObject(animations)){$container.stop(!0).animate(animations,config.duration===undefined?'fast':config.duration);$container.queue(function(next){deferred.resolve();next()})}else{deferred.resolve()}
return deferred.promise()};OO.ui.Element.static.reconsiderScrollbars=function(el){var i,len,scrollLeft,scrollTop,nodes=[];scrollLeft=el.scrollLeft;scrollTop=el.scrollTop;while(el.firstChild){nodes.push(el.firstChild);el.removeChild(el.firstChild)}
void el.offsetHeight;for(i=0,len=nodes.length;i<len;i++){el.appendChild(nodes[i])}
el.scrollLeft=scrollLeft;el.scrollTop=scrollTop};OO.ui.Element.prototype.toggle=function(show){show=show===undefined?!this.visible:!!show;if(show!==this.isVisible()){this.visible=show;this.$element.toggleClass('oo-ui-element-hidden',!this.visible);this.emit('toggle',show)}
return this};OO.ui.Element.prototype.isVisible=function(){return this.visible};OO.ui.Element.prototype.getData=function(){return this.data};OO.ui.Element.prototype.setData=function(data){this.data=data;return this};OO.ui.Element.prototype.setElementId=function(id){this.elementId=id;this.$element.attr('id',id);return this};OO.ui.Element.prototype.getElementId=function(){if(this.elementId===null){this.setElementId(OO.ui.generateElementId())}
return this.elementId};OO.ui.Element.prototype.supports=function(methods){var i,len,support=0;methods=Array.isArray(methods)?methods:[methods];for(i=0,len=methods.length;i<len;i++){if($.isFunction(this[methods[i]])){support++}}
return methods.length===support};OO.ui.Element.prototype.updateThemeClasses=function(){OO.ui.theme.queueUpdateElementClasses(this)};OO.ui.Element.prototype.getTagName=function(){return this.constructor.static.tagName};OO.ui.Element.prototype.isElementAttached=function(){return $.contains(this.getElementDocument(),this.$element[0])};OO.ui.Element.prototype.getElementDocument=function(){return OO.ui.Element.static.getDocument(this.$element)};OO.ui.Element.prototype.getElementWindow=function(){return OO.ui.Element.static.getWindow(this.$element)};OO.ui.Element.prototype.getClosestScrollableElementContainer=function(){return OO.ui.Element.static.getClosestScrollableContainer(this.$element[0])};OO.ui.Element.prototype.getElementGroup=function(){return this.elementGroup};OO.ui.Element.prototype.setElementGroup=function(group){this.elementGroup=group;return this};OO.ui.Element.prototype.scrollElementIntoView=function(config){if(!this.isElementAttached()||!this.isVisible()||(this.getElementGroup()&&!this.getElementGroup().isVisible())){return $.Deferred().resolve()}
return OO.ui.Element.static.scrollIntoView(this.$element[0],config)};OO.ui.Element.prototype.restorePreInfuseState=function(){};OO.ui.HtmlSnippet=function OoUiHtmlSnippet(content){this.content=content};OO.initClass(OO.ui.HtmlSnippet);OO.ui.HtmlSnippet.prototype.toString=function(){return this.content};OO.ui.Layout=function OoUiLayout(config){config=config||{};OO.ui.Layout.parent.call(this,config);OO.EventEmitter.call(this);this.$element.addClass('oo-ui-layout')};OO.inheritClass(OO.ui.Layout,OO.ui.Element);OO.mixinClass(OO.ui.Layout,OO.EventEmitter);OO.ui.Widget=function OoUiWidget(config){config=$.extend({disabled:!1},config);OO.ui.Widget.parent.call(this,config);OO.EventEmitter.call(this);this.disabled=null;this.wasDisabled=null;this.$element.addClass('oo-ui-widget');this.setDisabled(!!config.disabled)};OO.inheritClass(OO.ui.Widget,OO.ui.Element);OO.mixinClass(OO.ui.Widget,OO.EventEmitter);OO.ui.Widget.prototype.isDisabled=function(){return this.disabled};OO.ui.Widget.prototype.setDisabled=function(disabled){var isDisabled;this.disabled=!!disabled;isDisabled=this.isDisabled();if(isDisabled!==this.wasDisabled){this.$element.toggleClass('oo-ui-widget-disabled',isDisabled);this.$element.toggleClass('oo-ui-widget-enabled',!isDisabled);this.$element.attr('aria-disabled',isDisabled.toString());this.emit('disable',isDisabled);this.updateThemeClasses()}
this.wasDisabled=isDisabled;return this};OO.ui.Widget.prototype.updateDisabled=function(){this.setDisabled(this.disabled);return this};OO.ui.Widget.prototype.getInputId=function(){return null};OO.ui.Widget.prototype.simulateLabelClick=function(){};OO.ui.Theme=function OoUiTheme(){this.elementClassesQueue=[];this.debouncedUpdateQueuedElementClasses=OO.ui.debounce(this.updateQueuedElementClasses)};OO.initClass(OO.ui.Theme);OO.ui.Theme.prototype.getElementClasses=function(){return{on:[],off:[]}};OO.ui.Theme.prototype.updateElementClasses=function(element){var $elements=$([]),classes=this.getElementClasses(element);if(element.$icon){$elements=$elements.add(element.$icon)}
if(element.$indicator){$elements=$elements.add(element.$indicator)}
$elements.removeClass(classes.off.join(' ')).addClass(classes.on.join(' '))};OO.ui.Theme.prototype.updateQueuedElementClasses=function(){var i;for(i=0;i<this.elementClassesQueue.length;i++){this.updateElementClasses(this.elementClassesQueue[i])}
this.elementClassesQueue=[]};OO.ui.Theme.prototype.queueUpdateElementClasses=function(element){if(this.elementClassesQueue.lastIndexOf(element)!==-1){return}
this.elementClassesQueue.push(element);this.debouncedUpdateQueuedElementClasses()};OO.ui.Theme.prototype.getDialogTransitionDuration=function(){return 0};OO.ui.mixin.TabIndexedElement=function OoUiMixinTabIndexedElement(config){config=$.extend({tabIndex:0},config);this.$tabIndexed=null;this.tabIndex=null;this.connect(this,{disable:'onTabIndexedElementDisable'});this.setTabIndex(config.tabIndex);this.setTabIndexedElement(config.$tabIndexed||this.$element)};OO.initClass(OO.ui.mixin.TabIndexedElement);OO.ui.mixin.TabIndexedElement.prototype.setTabIndexedElement=function($tabIndexed){var tabIndex=this.tabIndex;this.setTabIndex(null);this.$tabIndexed=$tabIndexed;this.tabIndex=tabIndex;return this.updateTabIndex()};OO.ui.mixin.TabIndexedElement.prototype.setTabIndex=function(tabIndex){tabIndex=/^-?\d+$/.test(tabIndex)?Number(tabIndex):null;if(this.tabIndex!==tabIndex){this.tabIndex=tabIndex;this.updateTabIndex()}
return this};OO.ui.mixin.TabIndexedElement.prototype.updateTabIndex=function(){if(this.$tabIndexed){if(this.tabIndex!==null){this.$tabIndexed.attr({tabindex:this.isDisabled()?-1:this.tabIndex,'aria-disabled':this.isDisabled().toString()})}else{this.$tabIndexed.removeAttr('tabindex aria-disabled')}}
return this};OO.ui.mixin.TabIndexedElement.prototype.onTabIndexedElementDisable=function(){this.updateTabIndex()};OO.ui.mixin.TabIndexedElement.prototype.getTabIndex=function(){return this.tabIndex};OO.ui.mixin.TabIndexedElement.prototype.getInputId=function(){var id;if(!this.$tabIndexed){return null}
if(!this.isLabelableNode(this.$tabIndexed)){return null}
id=this.$tabIndexed.attr('id');if(id===undefined){id=OO.ui.generateElementId();this.$tabIndexed.attr('id',id)}
return id};OO.ui.mixin.TabIndexedElement.prototype.isLabelableNode=function($node){var
labelableTags=['button','meter','output','progress','select','textarea'],tagName=$node.prop('tagName').toLowerCase();if(tagName==='input'&&$node.attr('type')!=='hidden'){return!0}
if(labelableTags.indexOf(tagName)!==-1){return!0}
return!1};OO.ui.mixin.TabIndexedElement.prototype.focus=function(){if(!this.isDisabled()){this.$tabIndexed.focus()}
return this};OO.ui.mixin.TabIndexedElement.prototype.blur=function(){this.$tabIndexed.blur();return this};OO.ui.mixin.TabIndexedElement.prototype.simulateLabelClick=function(){this.focus()};OO.ui.mixin.ButtonElement=function OoUiMixinButtonElement(config){config=config||{};this.$button=null;this.framed=null;this.active=config.active!==undefined&&config.active;this.onMouseUpHandler=this.onMouseUp.bind(this);this.onMouseDownHandler=this.onMouseDown.bind(this);this.onKeyDownHandler=this.onKeyDown.bind(this);this.onKeyUpHandler=this.onKeyUp.bind(this);this.onClickHandler=this.onClick.bind(this);this.onKeyPressHandler=this.onKeyPress.bind(this);this.$element.addClass('oo-ui-buttonElement');this.toggleFramed(config.framed===undefined||config.framed);this.setButtonElement(config.$button||$('<a>'))};OO.initClass(OO.ui.mixin.ButtonElement);OO.ui.mixin.ButtonElement.static.cancelButtonMouseDownEvents=!0;OO.ui.mixin.ButtonElement.prototype.setButtonElement=function($button){if(this.$button){this.$button.removeClass('oo-ui-buttonElement-button').removeAttr('role accesskey').off({mousedown:this.onMouseDownHandler,keydown:this.onKeyDownHandler,click:this.onClickHandler,keypress:this.onKeyPressHandler})}
this.$button=$button.addClass('oo-ui-buttonElement-button').on({mousedown:this.onMouseDownHandler,keydown:this.onKeyDownHandler,click:this.onClickHandler,keypress:this.onKeyPressHandler});if(this.$button.prop('tagName').toUpperCase()==='A'){this.$button.attr('role','button')}};OO.ui.mixin.ButtonElement.prototype.onMouseDown=function(e){if(this.isDisabled()||e.which!==OO.ui.MouseButtons.LEFT){return}
this.$element.addClass('oo-ui-buttonElement-pressed');this.getElementDocument().addEventListener('mouseup',this.onMouseUpHandler,!0);if(this.constructor.static.cancelButtonMouseDownEvents){return!1}};OO.ui.mixin.ButtonElement.prototype.onMouseUp=function(e){if(this.isDisabled()||e.which!==OO.ui.MouseButtons.LEFT){return}
this.$element.removeClass('oo-ui-buttonElement-pressed');this.getElementDocument().removeEventListener('mouseup',this.onMouseUpHandler,!0)};OO.ui.mixin.ButtonElement.prototype.onClick=function(e){if(!this.isDisabled()&&e.which===OO.ui.MouseButtons.LEFT){if(this.emit('click')){return!1}}};OO.ui.mixin.ButtonElement.prototype.onKeyDown=function(e){if(this.isDisabled()||(e.which!==OO.ui.Keys.SPACE&&e.which!==OO.ui.Keys.ENTER)){return}
this.$element.addClass('oo-ui-buttonElement-pressed');this.getElementDocument().addEventListener('keyup',this.onKeyUpHandler,!0)};OO.ui.mixin.ButtonElement.prototype.onKeyUp=function(e){if(this.isDisabled()||(e.which!==OO.ui.Keys.SPACE&&e.which!==OO.ui.Keys.ENTER)){return}
this.$element.removeClass('oo-ui-buttonElement-pressed');this.getElementDocument().removeEventListener('keyup',this.onKeyUpHandler,!0)};OO.ui.mixin.ButtonElement.prototype.onKeyPress=function(e){if(!this.isDisabled()&&(e.which===OO.ui.Keys.SPACE||e.which===OO.ui.Keys.ENTER)){if(this.emit('click')){return!1}}};OO.ui.mixin.ButtonElement.prototype.isFramed=function(){return this.framed};OO.ui.mixin.ButtonElement.prototype.toggleFramed=function(framed){framed=framed===undefined?!this.framed:!!framed;if(framed!==this.framed){this.framed=framed;this.$element.toggleClass('oo-ui-buttonElement-frameless',!framed).toggleClass('oo-ui-buttonElement-framed',framed);this.updateThemeClasses()}
return this};OO.ui.mixin.ButtonElement.prototype.setActive=function(value){this.active=!!value;this.$element.toggleClass('oo-ui-buttonElement-active',this.active);this.updateThemeClasses();return this};OO.ui.mixin.ButtonElement.prototype.isActive=function(){return this.active};OO.ui.mixin.GroupElement=function OoUiMixinGroupElement(config){config=config||{};OO.EmitterList.call(this,config);this.$group=null;this.setGroupElement(config.$group||$('<div>'))};OO.mixinClass(OO.ui.mixin.GroupElement,OO.EmitterList);OO.ui.mixin.GroupElement.prototype.setGroupElement=function($group){var i,len;this.$group=$group;for(i=0,len=this.items.length;i<len;i++){this.$group.append(this.items[i].$element)}};OO.ui.mixin.GroupElement.prototype.findItemFromData=function(data){var i,len,item,hash=OO.getHash(data);for(i=0,len=this.items.length;i<len;i++){item=this.items[i];if(hash===OO.getHash(item.getData())){return item}}
return null};OO.ui.mixin.GroupElement.prototype.getItemFromData=function(data){OO.ui.warnDeprecation('GroupElement#getItemFromData. Deprecated function. Use findItemFromData instead. See T76630');return this.findItemFromData(data)};OO.ui.mixin.GroupElement.prototype.findItemsFromData=function(data){var i,len,item,hash=OO.getHash(data),items=[];for(i=0,len=this.items.length;i<len;i++){item=this.items[i];if(hash===OO.getHash(item.getData())){items.push(item)}}
return items};OO.ui.mixin.GroupElement.prototype.getItemsFromData=function(data){OO.ui.warnDeprecation('GroupElement#getItemsFromData. Deprecated function. Use findItemsFromData instead. See T76630');return this.findItemsFromData(data)};OO.ui.mixin.GroupElement.prototype.addItems=function(items,index){OO.EmitterList.prototype.addItems.call(this,items,index);this.emit('change',this.getItems());return this};OO.ui.mixin.GroupElement.prototype.moveItem=function(items,newIndex){this.insertItemElements(items,newIndex);newIndex=OO.EmitterList.prototype.moveItem.call(this,items,newIndex);return newIndex};OO.ui.mixin.GroupElement.prototype.insertItem=function(item,index){item.setElementGroup(this);this.insertItemElements(item,index);index=OO.EmitterList.prototype.insertItem.call(this,item,index);return index};OO.ui.mixin.GroupElement.prototype.insertItemElements=function(itemWidget,index){if(index===undefined||index<0||index>=this.items.length){this.$group.append(itemWidget.$element)}else if(index===0){this.$group.prepend(itemWidget.$element)}else{this.items[index].$element.before(itemWidget.$element)}};OO.ui.mixin.GroupElement.prototype.removeItems=function(items){var i,len,item,index;for(i=0,len=items.length;i<len;i++){item=items[i];index=this.items.indexOf(item);if(index!==-1){item.setElementGroup(null);item.$element.detach()}}
OO.EmitterList.prototype.removeItems.call(this,items);this.emit('change',this.getItems());return this};OO.ui.mixin.GroupElement.prototype.clearItems=function(){var i,len;for(i=0,len=this.items.length;i<len;i++){this.items[i].setElementGroup(null);this.items[i].$element.detach()}
OO.EmitterList.prototype.clearItems.call(this);this.emit('change',this.getItems());return this};OO.ui.mixin.IconElement=function OoUiMixinIconElement(config){config=config||{};this.$icon=null;this.icon=null;this.iconTitle=null;this.setIcon(config.icon||this.constructor.static.icon);this.setIconTitle(config.iconTitle||this.constructor.static.iconTitle);this.setIconElement(config.$icon||$('<span>'))};OO.initClass(OO.ui.mixin.IconElement);OO.ui.mixin.IconElement.static.icon=null;OO.ui.mixin.IconElement.static.iconTitle=null;OO.ui.mixin.IconElement.prototype.setIconElement=function($icon){if(this.$icon){this.$icon.removeClass('oo-ui-iconElement-icon oo-ui-icon-'+this.icon).removeAttr('title')}
this.$icon=$icon.addClass('oo-ui-iconElement-icon').toggleClass('oo-ui-icon-'+this.icon,!!this.icon);if(this.iconTitle!==null){this.$icon.attr('title',this.iconTitle)}
this.updateThemeClasses()};OO.ui.mixin.IconElement.prototype.setIcon=function(icon){icon=OO.isPlainObject(icon)?OO.ui.getLocalValue(icon,null,'default'):icon;icon=typeof icon==='string'&&icon.trim().length?icon.trim():null;if(this.icon!==icon){if(this.$icon){if(this.icon!==null){this.$icon.removeClass('oo-ui-icon-'+this.icon)}
if(icon!==null){this.$icon.addClass('oo-ui-icon-'+icon)}}
this.icon=icon}
this.$element.toggleClass('oo-ui-iconElement',!!this.icon);this.updateThemeClasses();return this};OO.ui.mixin.IconElement.prototype.setIconTitle=function(iconTitle){iconTitle=(typeof iconTitle==='function'||(typeof iconTitle==='string'&&iconTitle.length))?OO.ui.resolveMsg(iconTitle):null;if(this.iconTitle!==iconTitle){this.iconTitle=iconTitle;if(this.$icon){if(this.iconTitle!==null){this.$icon.attr('title',iconTitle)}else{this.$icon.removeAttr('title')}}}
return this};OO.ui.mixin.IconElement.prototype.getIcon=function(){return this.icon};OO.ui.mixin.IconElement.prototype.getIconTitle=function(){return this.iconTitle};OO.ui.mixin.IndicatorElement=function OoUiMixinIndicatorElement(config){config=config||{};this.$indicator=null;this.indicator=null;this.indicatorTitle=null;this.setIndicator(config.indicator||this.constructor.static.indicator);this.setIndicatorTitle(config.indicatorTitle||this.constructor.static.indicatorTitle);this.setIndicatorElement(config.$indicator||$('<span>'))};OO.initClass(OO.ui.mixin.IndicatorElement);OO.ui.mixin.IndicatorElement.static.indicator=null;OO.ui.mixin.IndicatorElement.static.indicatorTitle=null;OO.ui.mixin.IndicatorElement.prototype.setIndicatorElement=function($indicator){if(this.$indicator){this.$indicator.removeClass('oo-ui-indicatorElement-indicator oo-ui-indicator-'+this.indicator).removeAttr('title')}
this.$indicator=$indicator.addClass('oo-ui-indicatorElement-indicator').toggleClass('oo-ui-indicator-'+this.indicator,!!this.indicator);if(this.indicatorTitle!==null){this.$indicator.attr('title',this.indicatorTitle)}
this.updateThemeClasses()};OO.ui.mixin.IndicatorElement.prototype.setIndicator=function(indicator){indicator=typeof indicator==='string'&&indicator.length?indicator.trim():null;if(this.indicator!==indicator){if(this.$indicator){if(this.indicator!==null){this.$indicator.removeClass('oo-ui-indicator-'+this.indicator)}
if(indicator!==null){this.$indicator.addClass('oo-ui-indicator-'+indicator)}}
this.indicator=indicator}
this.$element.toggleClass('oo-ui-indicatorElement',!!this.indicator);this.updateThemeClasses();return this};OO.ui.mixin.IndicatorElement.prototype.setIndicatorTitle=function(indicatorTitle){indicatorTitle=(typeof indicatorTitle==='function'||(typeof indicatorTitle==='string'&&indicatorTitle.length))?OO.ui.resolveMsg(indicatorTitle):null;if(this.indicatorTitle!==indicatorTitle){this.indicatorTitle=indicatorTitle;if(this.$indicator){if(this.indicatorTitle!==null){this.$indicator.attr('title',indicatorTitle)}else{this.$indicator.removeAttr('title')}}}
return this};OO.ui.mixin.IndicatorElement.prototype.getIndicator=function(){return this.indicator};OO.ui.mixin.IndicatorElement.prototype.getIndicatorTitle=function(){return this.indicatorTitle};OO.ui.mixin.LabelElement=function OoUiMixinLabelElement(config){config=config||{};this.$label=null;this.label=null;this.setLabel(config.label||this.constructor.static.label);this.setLabelElement(config.$label||$('<span>'))};OO.initClass(OO.ui.mixin.LabelElement);OO.ui.mixin.LabelElement.static.label=null;OO.ui.mixin.LabelElement.static.highlightQuery=function(text,query,compare){var i,tLen,qLen,offset=-1,$result=$('<span>');if(compare){tLen=text.length;qLen=query.length;for(i=0;offset===-1&&i<=tLen-qLen;i++){if(compare(query,text.slice(i,i+qLen))===0){offset=i}}}else{offset=text.toLowerCase().indexOf(query.toLowerCase())}
if(!query.length||offset===-1){$result.text(text)}else{$result.append(document.createTextNode(text.slice(0,offset)),$('<span>').addClass('oo-ui-labelElement-label-highlight').text(text.slice(offset,offset+query.length)),document.createTextNode(text.slice(offset+query.length)))}
return $result.contents()};OO.ui.mixin.LabelElement.prototype.setLabelElement=function($label){if(this.$label){this.$label.removeClass('oo-ui-labelElement-label').empty()}
this.$label=$label.addClass('oo-ui-labelElement-label');this.setLabelContent(this.label)};OO.ui.mixin.LabelElement.prototype.setLabel=function(label){label=typeof label==='function'?OO.ui.resolveMsg(label):label;label=((typeof label==='string'||label instanceof jQuery)&&label.length)||(label instanceof OO.ui.HtmlSnippet&&label.toString().length)?label:null;if(this.label!==label){if(this.$label){this.setLabelContent(label)}
this.label=label;this.emit('labelChange')}
this.$element.toggleClass('oo-ui-labelElement',!!this.label);return this};OO.ui.mixin.LabelElement.prototype.setHighlightedQuery=function(text,query,compare){return this.setLabel(this.constructor.static.highlightQuery(text,query,compare))};OO.ui.mixin.LabelElement.prototype.getLabel=function(){return this.label};OO.ui.mixin.LabelElement.prototype.setLabelContent=function(label){if(typeof label==='string'){if(label.match(/^\s*$/)){this.$label.html('&nbsp;')}else{this.$label.text(label)}}else if(label instanceof OO.ui.HtmlSnippet){this.$label.html(label.toString())}else if(label instanceof jQuery){this.$label.empty().append(label)}else{this.$label.empty()}};OO.ui.mixin.FlaggedElement=function OoUiMixinFlaggedElement(config){config=config||{};this.flags={};this.$flagged=null;this.setFlags(config.flags);this.setFlaggedElement(config.$flagged||this.$element)};OO.ui.mixin.FlaggedElement.prototype.setFlaggedElement=function($flagged){var classNames=Object.keys(this.flags).map(function(flag){return'oo-ui-flaggedElement-'+flag}).join(' ');if(this.$flagged){this.$flagged.removeClass(classNames)}
this.$flagged=$flagged.addClass(classNames)};OO.ui.mixin.FlaggedElement.prototype.hasFlag=function(flag){return this.flags&&(flag in this.flags)};OO.ui.mixin.FlaggedElement.prototype.getFlags=function(){return Object.keys(this.flags||{})};OO.ui.mixin.FlaggedElement.prototype.clearFlags=function(){var flag,className,changes={},remove=[],classPrefix='oo-ui-flaggedElement-';for(flag in this.flags){className=classPrefix+flag;changes[flag]=!1;delete this.flags[flag];remove.push(className)}
if(this.$flagged){this.$flagged.removeClass(remove.join(' '))}
this.updateThemeClasses();this.emit('flag',changes);return this};OO.ui.mixin.FlaggedElement.prototype.setFlags=function(flags){var i,len,flag,className,changes={},add=[],remove=[],classPrefix='oo-ui-flaggedElement-';if(typeof flags==='string'){className=classPrefix+flags;if(!this.flags[flags]){this.flags[flags]=!0;add.push(className)}}else if(Array.isArray(flags)){for(i=0,len=flags.length;i<len;i++){flag=flags[i];className=classPrefix+flag;if(!this.flags[flag]){changes[flag]=!0;this.flags[flag]=!0;add.push(className)}}}else if(OO.isPlainObject(flags)){for(flag in flags){className=classPrefix+flag;if(flags[flag]){if(!this.flags[flag]){changes[flag]=!0;this.flags[flag]=!0;add.push(className)}}else{if(this.flags[flag]){changes[flag]=!1;delete this.flags[flag];remove.push(className)}}}}
if(this.$flagged){this.$flagged.addClass(add.join(' ')).removeClass(remove.join(' '))}
this.updateThemeClasses();this.emit('flag',changes);return this};OO.ui.mixin.TitledElement=function OoUiMixinTitledElement(config){config=config||{};this.$titled=null;this.title=null;this.setTitle(config.title!==undefined?config.title:this.constructor.static.title);this.setTitledElement(config.$titled||this.$element)};OO.initClass(OO.ui.mixin.TitledElement);OO.ui.mixin.TitledElement.static.title=null;OO.ui.mixin.TitledElement.prototype.setTitledElement=function($titled){if(this.$titled){this.$titled.removeAttr('title')}
this.$titled=$titled;if(this.title){this.updateTitle()}};OO.ui.mixin.TitledElement.prototype.setTitle=function(title){title=typeof title==='function'?OO.ui.resolveMsg(title):title;title=(typeof title==='string'&&title.length)?title:null;if(this.title!==title){this.title=title;this.updateTitle()}
return this};OO.ui.mixin.TitledElement.prototype.updateTitle=function(){var title=this.getTitle();if(this.$titled){if(title!==null){if(this.formatTitleWithAccessKey){title=this.formatTitleWithAccessKey(title)}
this.$titled.attr('title',title)}else{this.$titled.removeAttr('title')}}
return this};OO.ui.mixin.TitledElement.prototype.getTitle=function(){return this.title};OO.ui.mixin.AccessKeyedElement=function OoUiMixinAccessKeyedElement(config){config=config||{};this.$accessKeyed=null;this.accessKey=null;this.setAccessKey(config.accessKey||null);this.setAccessKeyedElement(config.$accessKeyed||this.$element);if(this.updateTitle){this.updateTitle()}};OO.initClass(OO.ui.mixin.AccessKeyedElement);OO.ui.mixin.AccessKeyedElement.static.accessKey=null;OO.ui.mixin.AccessKeyedElement.prototype.setAccessKeyedElement=function($accessKeyed){if(this.$accessKeyed){this.$accessKeyed.removeAttr('accesskey')}
this.$accessKeyed=$accessKeyed;if(this.accessKey){this.$accessKeyed.attr('accesskey',this.accessKey)}};OO.ui.mixin.AccessKeyedElement.prototype.setAccessKey=function(accessKey){accessKey=typeof accessKey==='string'?OO.ui.resolveMsg(accessKey):null;if(this.accessKey!==accessKey){if(this.$accessKeyed){if(accessKey!==null){this.$accessKeyed.attr('accesskey',accessKey)}else{this.$accessKeyed.removeAttr('accesskey')}}
this.accessKey=accessKey;if(this.updateTitle){this.updateTitle()}}
return this};OO.ui.mixin.AccessKeyedElement.prototype.getAccessKey=function(){return this.accessKey};OO.ui.mixin.AccessKeyedElement.prototype.formatTitleWithAccessKey=function(title){var accessKey;if(!this.$accessKeyed){return title}
if($.fn.updateTooltipAccessKeys&&$.fn.updateTooltipAccessKeys.getAccessKeyLabel){accessKey=$.fn.updateTooltipAccessKeys.getAccessKeyLabel(this.$accessKeyed[0])}else{accessKey=this.getAccessKey()}
if(accessKey){title+=' ['+accessKey+']'}
return title};OO.ui.ButtonWidget=function OoUiButtonWidget(config){config=config||{};OO.ui.ButtonWidget.parent.call(this,config);OO.ui.mixin.ButtonElement.call(this,config);OO.ui.mixin.IconElement.call(this,config);OO.ui.mixin.IndicatorElement.call(this,config);OO.ui.mixin.LabelElement.call(this,config);OO.ui.mixin.TitledElement.call(this,$.extend({},config,{$titled:this.$button}));OO.ui.mixin.FlaggedElement.call(this,config);OO.ui.mixin.TabIndexedElement.call(this,$.extend({},config,{$tabIndexed:this.$button}));OO.ui.mixin.AccessKeyedElement.call(this,$.extend({},config,{$accessKeyed:this.$button}));this.href=null;this.target=null;this.noFollow=!1;this.connect(this,{disable:'onDisable'});this.$button.append(this.$icon,this.$label,this.$indicator);this.$element.addClass('oo-ui-buttonWidget').append(this.$button);this.setActive(config.active);this.setHref(config.href);this.setTarget(config.target);this.setNoFollow(config.noFollow)};OO.inheritClass(OO.ui.ButtonWidget,OO.ui.Widget);OO.mixinClass(OO.ui.ButtonWidget,OO.ui.mixin.ButtonElement);OO.mixinClass(OO.ui.ButtonWidget,OO.ui.mixin.IconElement);OO.mixinClass(OO.ui.ButtonWidget,OO.ui.mixin.IndicatorElement);OO.mixinClass(OO.ui.ButtonWidget,OO.ui.mixin.LabelElement);OO.mixinClass(OO.ui.ButtonWidget,OO.ui.mixin.TitledElement);OO.mixinClass(OO.ui.ButtonWidget,OO.ui.mixin.FlaggedElement);OO.mixinClass(OO.ui.ButtonWidget,OO.ui.mixin.TabIndexedElement);OO.mixinClass(OO.ui.ButtonWidget,OO.ui.mixin.AccessKeyedElement);OO.ui.ButtonWidget.static.cancelButtonMouseDownEvents=!1;OO.ui.ButtonWidget.static.tagName='span';OO.ui.ButtonWidget.prototype.getHref=function(){return this.href};OO.ui.ButtonWidget.prototype.getTarget=function(){return this.target};OO.ui.ButtonWidget.prototype.getNoFollow=function(){return this.noFollow};OO.ui.ButtonWidget.prototype.setHref=function(href){href=typeof href==='string'?href:null;if(href!==null&&!OO.ui.isSafeUrl(href)){href='./'+href}
if(href!==this.href){this.href=href;this.updateHref()}
return this};OO.ui.ButtonWidget.prototype.updateHref=function(){if(this.href!==null&&!this.isDisabled()){this.$button.attr('href',this.href)}else{this.$button.removeAttr('href')}
return this};OO.ui.ButtonWidget.prototype.onDisable=function(){this.updateHref()};OO.ui.ButtonWidget.prototype.setTarget=function(target){target=typeof target==='string'?target:null;if(target!==this.target){this.target=target;if(target!==null){this.$button.attr('target',target)}else{this.$button.removeAttr('target')}}
return this};OO.ui.ButtonWidget.prototype.setNoFollow=function(noFollow){noFollow=typeof noFollow==='boolean'?noFollow:!0;if(noFollow!==this.noFollow){this.noFollow=noFollow;if(noFollow){this.$button.attr('rel','nofollow')}else{this.$button.removeAttr('rel')}}
return this};OO.ui.ButtonGroupWidget=function OoUiButtonGroupWidget(config){config=config||{};OO.ui.ButtonGroupWidget.parent.call(this,config);OO.ui.mixin.GroupElement.call(this,$.extend({},config,{$group:this.$element}));this.$element.addClass('oo-ui-buttonGroupWidget');if(Array.isArray(config.items)){this.addItems(config.items)}};OO.inheritClass(OO.ui.ButtonGroupWidget,OO.ui.Widget);OO.mixinClass(OO.ui.ButtonGroupWidget,OO.ui.mixin.GroupElement);OO.ui.ButtonGroupWidget.static.tagName='span';OO.ui.ButtonGroupWidget.prototype.focus=function(){if(!this.isDisabled()){if(this.items[0]){this.items[0].focus()}}
return this};OO.ui.ButtonGroupWidget.prototype.simulateLabelClick=function(){this.focus()};OO.ui.IconWidget=function OoUiIconWidget(config){config=config||{};OO.ui.IconWidget.parent.call(this,config);OO.ui.mixin.IconElement.call(this,$.extend({},config,{$icon:this.$element}));OO.ui.mixin.TitledElement.call(this,$.extend({},config,{$titled:this.$element}));OO.ui.mixin.FlaggedElement.call(this,$.extend({},config,{$flagged:this.$element}));this.$element.addClass('oo-ui-iconWidget')};OO.inheritClass(OO.ui.IconWidget,OO.ui.Widget);OO.mixinClass(OO.ui.IconWidget,OO.ui.mixin.IconElement);OO.mixinClass(OO.ui.IconWidget,OO.ui.mixin.TitledElement);OO.mixinClass(OO.ui.IconWidget,OO.ui.mixin.FlaggedElement);OO.ui.IconWidget.static.tagName='span';OO.ui.IndicatorWidget=function OoUiIndicatorWidget(config){config=config||{};OO.ui.IndicatorWidget.parent.call(this,config);OO.ui.mixin.IndicatorElement.call(this,$.extend({},config,{$indicator:this.$element}));OO.ui.mixin.TitledElement.call(this,$.extend({},config,{$titled:this.$element}));this.$element.addClass('oo-ui-indicatorWidget')};OO.inheritClass(OO.ui.IndicatorWidget,OO.ui.Widget);OO.mixinClass(OO.ui.IndicatorWidget,OO.ui.mixin.IndicatorElement);OO.mixinClass(OO.ui.IndicatorWidget,OO.ui.mixin.TitledElement);OO.ui.IndicatorWidget.static.tagName='span';OO.ui.LabelWidget=function OoUiLabelWidget(config){config=config||{};OO.ui.LabelWidget.parent.call(this,config);OO.ui.mixin.LabelElement.call(this,$.extend({},config,{$label:this.$element}));OO.ui.mixin.TitledElement.call(this,config);this.input=config.input;if(this.input){if(this.input.getInputId()){this.$element.attr('for',this.input.getInputId())}else{this.$label.on('click',function(){this.input.simulateLabelClick()}.bind(this))}}
this.$element.addClass('oo-ui-labelWidget')};OO.inheritClass(OO.ui.LabelWidget,OO.ui.Widget);OO.mixinClass(OO.ui.LabelWidget,OO.ui.mixin.LabelElement);OO.mixinClass(OO.ui.LabelWidget,OO.ui.mixin.TitledElement);OO.ui.LabelWidget.static.tagName='label';OO.ui.mixin.PendingElement=function OoUiMixinPendingElement(config){config=config||{};this.pending=0;this.$pending=null;this.setPendingElement(config.$pending||this.$element)};OO.initClass(OO.ui.mixin.PendingElement);OO.ui.mixin.PendingElement.prototype.setPendingElement=function($pending){if(this.$pending){this.$pending.removeClass('oo-ui-pendingElement-pending')}
this.$pending=$pending;if(this.pending>0){this.$pending.addClass('oo-ui-pendingElement-pending')}};OO.ui.mixin.PendingElement.prototype.isPending=function(){return!!this.pending};OO.ui.mixin.PendingElement.prototype.pushPending=function(){if(this.pending===0){this.$pending.addClass('oo-ui-pendingElement-pending');this.updateThemeClasses()}
this.pending++;return this};OO.ui.mixin.PendingElement.prototype.popPending=function(){if(this.pending===1){this.$pending.removeClass('oo-ui-pendingElement-pending');this.updateThemeClasses()}
this.pending=Math.max(0,this.pending-1);return this};OO.ui.mixin.FloatableElement=function OoUiMixinFloatableElement(config){config=config||{};this.$floatable=null;this.$floatableContainer=null;this.$floatableWindow=null;this.$floatableClosestScrollable=null;this.floatableOutOfView=!1;this.onFloatableScrollHandler=this.position.bind(this);this.onFloatableWindowResizeHandler=this.position.bind(this);this.setFloatableContainer(config.$floatableContainer);this.setFloatableElement(config.$floatable||this.$element);this.setVerticalPosition(config.verticalPosition||'below');this.setHorizontalPosition(config.horizontalPosition||'start');this.hideWhenOutOfView=config.hideWhenOutOfView===undefined?!0:!!config.hideWhenOutOfView};OO.ui.mixin.FloatableElement.prototype.setFloatableElement=function($floatable){if(this.$floatable){this.$floatable.removeClass('oo-ui-floatableElement-floatable');this.$floatable.css({left:'',top:''})}
this.$floatable=$floatable.addClass('oo-ui-floatableElement-floatable');this.position()};OO.ui.mixin.FloatableElement.prototype.setFloatableContainer=function($floatableContainer){this.$floatableContainer=$floatableContainer;if(this.$floatable){this.position()}};OO.ui.mixin.FloatableElement.prototype.setVerticalPosition=function(position){if(['below','above','top','bottom','center'].indexOf(position)===-1){throw new Error('Invalid value for vertical position: '+position)}
if(this.verticalPosition!==position){this.verticalPosition=position;if(this.$floatable){this.position()}}};OO.ui.mixin.FloatableElement.prototype.setHorizontalPosition=function(position){if(['before','after','start','end','center'].indexOf(position)===-1){throw new Error('Invalid value for horizontal position: '+position)}
if(this.horizontalPosition!==position){this.horizontalPosition=position;if(this.$floatable){this.position()}}};OO.ui.mixin.FloatableElement.prototype.togglePositioning=function(positioning){var closestScrollableOfContainer;if(!this.$floatable||!this.$floatableContainer){return this}
positioning=positioning===undefined?!this.positioning:!!positioning;if(positioning&&!this.warnedUnattached&&!this.isElementAttached()){OO.ui.warnDeprecation('FloatableElement#togglePositioning: Before calling this method, the element must be attached to the DOM.');this.warnedUnattached=!0}
if(this.positioning!==positioning){this.positioning=positioning;this.needsCustomPosition=this.verticalPostion!=='below'||this.horizontalPosition!=='start'||!OO.ui.contains(this.$floatableContainer[0],this.$floatable[0]);closestScrollableOfContainer=OO.ui.Element.static.getClosestScrollableContainer(this.$floatableContainer[0]);if($(closestScrollableOfContainer).is('html, body')){closestScrollableOfContainer=OO.ui.Element.static.getWindow(closestScrollableOfContainer)}
if(positioning){this.$floatableWindow=$(this.getElementWindow());this.$floatableWindow.on('resize',this.onFloatableWindowResizeHandler);this.$floatableClosestScrollable=$(closestScrollableOfContainer);this.$floatableClosestScrollable.on('scroll',this.onFloatableScrollHandler);this.position()}else{if(this.$floatableWindow){this.$floatableWindow.off('resize',this.onFloatableWindowResizeHandler);this.$floatableWindow=null}
if(this.$floatableClosestScrollable){this.$floatableClosestScrollable.off('scroll',this.onFloatableScrollHandler);this.$floatableClosestScrollable=null}
this.$floatable.css({left:'',right:'',top:''})}}
return this};OO.ui.mixin.FloatableElement.prototype.isElementInViewport=function($element,$container){var elemRect,contRect,topEdgeInBounds,bottomEdgeInBounds,leftEdgeInBounds,rightEdgeInBounds,startEdgeInBounds,endEdgeInBounds,viewportSpacing,direction=$element.css('direction');elemRect=$element[0].getBoundingClientRect();if($container[0]===window){viewportSpacing=OO.ui.getViewportSpacing();contRect={top:0,left:0,right:document.documentElement.clientWidth,bottom:document.documentElement.clientHeight};contRect.top+=viewportSpacing.top;contRect.left+=viewportSpacing.left;contRect.right-=viewportSpacing.right;contRect.bottom-=viewportSpacing.bottom}else{contRect=$container[0].getBoundingClientRect()}
topEdgeInBounds=elemRect.top>=contRect.top&&elemRect.top<=contRect.bottom;bottomEdgeInBounds=elemRect.bottom>=contRect.top&&elemRect.bottom<=contRect.bottom;leftEdgeInBounds=elemRect.left>=contRect.left&&elemRect.left<=contRect.right;rightEdgeInBounds=elemRect.right>=contRect.left&&elemRect.right<=contRect.right;if(direction==='rtl'){startEdgeInBounds=rightEdgeInBounds;endEdgeInBounds=leftEdgeInBounds}else{startEdgeInBounds=leftEdgeInBounds;endEdgeInBounds=rightEdgeInBounds}
if(this.verticalPosition==='below'&&!bottomEdgeInBounds){return!1}
if(this.verticalPosition==='above'&&!topEdgeInBounds){return!1}
if(this.horizontalPosition==='before'&&!startEdgeInBounds){return!1}
if(this.horizontalPosition==='after'&&!endEdgeInBounds){return!1}
return elemRect.top<=contRect.bottom&&elemRect.bottom>=contRect.top&&elemRect.left<=contRect.right&&elemRect.right>=contRect.left};OO.ui.mixin.FloatableElement.prototype.isFloatableOutOfView=function(){return this.floatableOutOfView};OO.ui.mixin.FloatableElement.prototype.position=function(){if(!this.positioning){return this}
if(!(this.isElementAttached()&&(this.$floatableClosestScrollable[0]===this.getElementWindow()||$.contains(this.getElementDocument(),this.$floatableClosestScrollable[0])))){return this}
this.floatableOutOfView=this.hideWhenOutOfView&&!this.isElementInViewport(this.$floatableContainer,this.$floatableClosestScrollable);if(this.floatableOutOfView){this.$floatable.addClass('oo-ui-element-hidden');return this}else{this.$floatable.removeClass('oo-ui-element-hidden')}
if(!this.needsCustomPosition){return this}
this.$floatable.css(this.computePosition());if(this.clip){this.clip()}
return this};OO.ui.mixin.FloatableElement.prototype.computePosition=function(){var isBody,scrollableX,scrollableY,containerPos,horizScrollbarHeight,vertScrollbarWidth,scrollTop,scrollLeft,newPos={top:'',left:'',bottom:'',right:''},direction=this.$floatableContainer.css('direction'),$offsetParent=this.$floatable.offsetParent();if($offsetParent.is('html')){$offsetParent=$($offsetParent[0].ownerDocument.body)}
isBody=$offsetParent.is('body');scrollableX=$offsetParent.css('overflow-x')==='scroll'||$offsetParent.css('overflow-x')==='auto';scrollableY=$offsetParent.css('overflow-y')==='scroll'||$offsetParent.css('overflow-y')==='auto';vertScrollbarWidth=$offsetParent.innerWidth()-$offsetParent.prop('clientWidth');horizScrollbarHeight=$offsetParent.innerHeight()-$offsetParent.prop('clientHeight');scrollTop=scrollableY&&!isBody?$offsetParent.scrollTop():0;scrollLeft=scrollableX&&!isBody?OO.ui.Element.static.getScrollLeft($offsetParent[0]):0;containerPos=isBody?this.$floatableContainer.offset():OO.ui.Element.static.getRelativePosition(this.$floatableContainer,$offsetParent);containerPos.bottom=containerPos.top+this.$floatableContainer.outerHeight();containerPos.right=containerPos.left+this.$floatableContainer.outerWidth();containerPos.start=direction==='rtl'?containerPos.right:containerPos.left;containerPos.end=direction==='rtl'?containerPos.left:containerPos.right;if(this.verticalPosition==='below'){newPos.top=containerPos.bottom}else if(this.verticalPosition==='above'){newPos.bottom=$offsetParent.outerHeight()-containerPos.top}else if(this.verticalPosition==='top'){newPos.top=containerPos.top}else if(this.verticalPosition==='bottom'){newPos.bottom=$offsetParent.outerHeight()-containerPos.bottom}else if(this.verticalPosition==='center'){newPos.top=containerPos.top+(this.$floatableContainer.height()-this.$floatable.height())/2}
if(this.horizontalPosition==='before'){newPos.end=containerPos.start}else if(this.horizontalPosition==='after'){newPos.start=containerPos.end}else if(this.horizontalPosition==='start'){newPos.start=containerPos.start}else if(this.horizontalPosition==='end'){newPos.end=containerPos.end}else if(this.horizontalPosition==='center'){newPos.left=containerPos.left+(this.$floatableContainer.width()-this.$floatable.width())/2}
if(newPos.start!==undefined){if(direction==='rtl'){newPos.right=(isBody?$($offsetParent[0].ownerDocument.documentElement):$offsetParent).outerWidth()-newPos.start}else{newPos.left=newPos.start}
delete newPos.start}
if(newPos.end!==undefined){if(direction==='rtl'){newPos.left=newPos.end}else{newPos.right=(isBody?$($offsetParent[0].ownerDocument.documentElement):$offsetParent).outerWidth()-newPos.end}
delete newPos.end}
if(newPos.top!==''){newPos.top+=scrollTop}
if(newPos.bottom!==''){newPos.bottom-=scrollTop}
if(newPos.left!==''){newPos.left+=scrollLeft}
if(newPos.right!==''){newPos.right-=scrollLeft}
if(newPos.bottom!==''){newPos.bottom-=horizScrollbarHeight}
if(direction==='rtl'){if(newPos.left!==''){newPos.left-=vertScrollbarWidth}}else{if(newPos.right!==''){newPos.right-=vertScrollbarWidth}}
return newPos};OO.ui.mixin.ClippableElement=function OoUiMixinClippableElement(config){config=config||{};this.$clippable=null;this.$clippableContainer=null;this.clipping=!1;this.clippedHorizontally=!1;this.clippedVertically=!1;this.$clippableScrollableContainer=null;this.$clippableScroller=null;this.$clippableWindow=null;this.idealWidth=null;this.idealHeight=null;this.onClippableScrollHandler=this.clip.bind(this);this.onClippableWindowResizeHandler=this.clip.bind(this);if(config.$clippableContainer){this.setClippableContainer(config.$clippableContainer)}
this.setClippableElement(config.$clippable||this.$element)};OO.ui.mixin.ClippableElement.prototype.setClippableElement=function($clippable){if(this.$clippable){this.$clippable.removeClass('oo-ui-clippableElement-clippable');this.$clippable.css({width:'',height:'',overflowX:'',overflowY:''});OO.ui.Element.static.reconsiderScrollbars(this.$clippable[0])}
this.$clippable=$clippable.addClass('oo-ui-clippableElement-clippable');this.clip()};OO.ui.mixin.ClippableElement.prototype.setClippableContainer=function($clippableContainer){this.$clippableContainer=$clippableContainer;if(this.$clippable){this.clip()}};OO.ui.mixin.ClippableElement.prototype.toggleClipping=function(clipping){clipping=clipping===undefined?!this.clipping:!!clipping;if(clipping&&!this.warnedUnattached&&!this.isElementAttached()){OO.ui.warnDeprecation('ClippableElement#toggleClipping: Before calling this method, the element must be attached to the DOM.');this.warnedUnattached=!0}
if(this.clipping!==clipping){this.clipping=clipping;if(clipping){this.$clippableScrollableContainer=$(this.getClosestScrollableElementContainer());this.$clippableScroller=this.$clippableScrollableContainer.is('html, body')?$(OO.ui.Element.static.getWindow(this.$clippableScrollableContainer)):this.$clippableScrollableContainer;this.$clippableScroller.on('scroll',this.onClippableScrollHandler);this.$clippableWindow=$(this.getElementWindow()).on('resize',this.onClippableWindowResizeHandler);this.clip()}else{this.$clippable.css({width:'',height:'',maxWidth:'',maxHeight:'',overflowX:'',overflowY:''});OO.ui.Element.static.reconsiderScrollbars(this.$clippable[0]);this.$clippableScrollableContainer=null;this.$clippableScroller.off('scroll',this.onClippableScrollHandler);this.$clippableScroller=null;this.$clippableWindow.off('resize',this.onClippableWindowResizeHandler);this.$clippableWindow=null}}
return this};OO.ui.mixin.ClippableElement.prototype.isClipping=function(){return this.clipping};OO.ui.mixin.ClippableElement.prototype.isClipped=function(){return this.clippedHorizontally||this.clippedVertically};OO.ui.mixin.ClippableElement.prototype.isClippedHorizontally=function(){return this.clippedHorizontally};OO.ui.mixin.ClippableElement.prototype.isClippedVertically=function(){return this.clippedVertically};OO.ui.mixin.ClippableElement.prototype.setIdealSize=function(width,height){this.idealWidth=width;this.idealHeight=height;if(!this.clipping){this.$clippable.css({width:width,height:height})}};OO.ui.mixin.ClippableElement.prototype.getHorizontalAnchorEdge=function(){if(this.computePosition&&this.positioning&&this.computePosition().right!==''){return'right'}
return'left'};OO.ui.mixin.ClippableElement.prototype.getVerticalAnchorEdge=function(){if(this.computePosition&&this.positioning&&this.computePosition().bottom!==''){return'bottom'}
return'top'};OO.ui.mixin.ClippableElement.prototype.clip=function(){var extraHeight,extraWidth,viewportSpacing,desiredWidth,desiredHeight,allotedWidth,allotedHeight,naturalWidth,naturalHeight,clipWidth,clipHeight,$item,itemRect,$viewport,viewportRect,availableRect,direction,vertScrollbarWidth,horizScrollbarHeight,buffer=7;if(!this.clipping){return this}
function rectIntersection(a,b){var out={};out.top=Math.max(a.top,b.top);out.left=Math.max(a.left,b.left);out.bottom=Math.min(a.bottom,b.bottom);out.right=Math.min(a.right,b.right);return out}
viewportSpacing=OO.ui.getViewportSpacing();if(this.$clippableScrollableContainer.is('html, body')){$viewport=$(this.$clippableScrollableContainer[0].ownerDocument.body);viewportRect={top:0,left:0,right:document.documentElement.clientWidth,bottom:document.documentElement.clientHeight};viewportRect.top+=viewportSpacing.top;viewportRect.left+=viewportSpacing.left;viewportRect.right-=viewportSpacing.right;viewportRect.bottom-=viewportSpacing.bottom}else{$viewport=this.$clippableScrollableContainer;viewportRect=$viewport[0].getBoundingClientRect();viewportRect=$.extend({},viewportRect)}
direction=$viewport.css('direction');vertScrollbarWidth=$viewport.innerWidth()-$viewport.prop('clientWidth');horizScrollbarHeight=$viewport.innerHeight()-$viewport.prop('clientHeight');viewportRect.bottom-=horizScrollbarHeight;if(direction==='rtl'){viewportRect.left+=vertScrollbarWidth}else{viewportRect.right-=vertScrollbarWidth}
viewportRect.top+=buffer;viewportRect.left+=buffer;viewportRect.right-=buffer;viewportRect.bottom-=buffer;$item=this.$clippableContainer||this.$clippable;extraHeight=$item.outerHeight()-this.$clippable.outerHeight();extraWidth=$item.outerWidth()-this.$clippable.outerWidth();itemRect=$item[0].getBoundingClientRect();itemRect=$.extend({},itemRect);if(this.getHorizontalAnchorEdge()==='right'){itemRect.left=viewportRect.left}else{itemRect.right=viewportRect.right}
if(this.getVerticalAnchorEdge()==='bottom'){itemRect.top=viewportRect.top}else{itemRect.bottom=viewportRect.bottom}
availableRect=rectIntersection(viewportRect,itemRect);desiredWidth=Math.max(0,availableRect.right-availableRect.left);desiredHeight=Math.max(0,availableRect.bottom-availableRect.top);desiredWidth=Math.min(desiredWidth,document.documentElement.clientWidth-viewportSpacing.left-viewportSpacing.right);desiredHeight=Math.min(desiredHeight,document.documentElement.clientHeight-viewportSpacing.top-viewportSpacing.right);allotedWidth=Math.ceil(desiredWidth-extraWidth);allotedHeight=Math.ceil(desiredHeight-extraHeight);naturalWidth=this.$clippable.prop('scrollWidth');naturalHeight=this.$clippable.prop('scrollHeight');clipWidth=allotedWidth<naturalWidth;clipHeight=allotedHeight<naturalHeight;if(clipWidth){this.$clippable.css('overflowX','scroll');void this.$clippable[0].offsetHeight;this.$clippable.css({width:Math.max(0,allotedWidth),maxWidth:''})}else{this.$clippable.css({overflowX:'',width:this.idealWidth||'',maxWidth:Math.max(0,allotedWidth)})}
if(clipHeight){this.$clippable.css('overflowY','scroll');void this.$clippable[0].offsetHeight;this.$clippable.css({height:Math.max(0,allotedHeight),maxHeight:''})}else{this.$clippable.css({overflowY:'',height:this.idealHeight||'',maxHeight:Math.max(0,allotedHeight)})}
if((this.clippedHorizontally&&!clipWidth)||(this.clippedVertically&&!clipHeight)){OO.ui.Element.static.reconsiderScrollbars(this.$clippable[0])}
this.clippedHorizontally=clipWidth;this.clippedVertically=clipHeight;return this};OO.ui.PopupWidget=function OoUiPopupWidget(config){config=config||{};OO.ui.PopupWidget.parent.call(this,config);this.$body=$('<div>');this.$popup=$('<div>');OO.ui.mixin.LabelElement.call(this,config);OO.ui.mixin.ClippableElement.call(this,$.extend({},config,{$clippable:this.$body,$clippableContainer:this.$popup}));OO.ui.mixin.FloatableElement.call(this,config);this.$anchor=$('<div>');this.$container=config.$container;this.containerPadding=config.containerPadding!==undefined?config.containerPadding:10;this.autoClose=!!config.autoClose;this.$autoCloseIgnore=config.$autoCloseIgnore;this.transitionTimeout=null;this.anchored=!1;this.width=config.width!==undefined?config.width:320;this.height=config.height!==undefined?config.height:null;this.onMouseDownHandler=this.onMouseDown.bind(this);this.onDocumentKeyDownHandler=this.onDocumentKeyDown.bind(this);this.toggleAnchor(config.anchor===undefined||config.anchor);this.setAlignment(config.align||'center');this.setPosition(config.position||'below');this.setAutoFlip(config.autoFlip===undefined||config.autoFlip);this.$body.addClass('oo-ui-popupWidget-body');this.$anchor.addClass('oo-ui-popupWidget-anchor');this.$popup.addClass('oo-ui-popupWidget-popup').append(this.$body);this.$element.addClass('oo-ui-popupWidget').append(this.$popup,this.$anchor);if(config.$content instanceof jQuery){this.$body.append(config.$content)}
if(config.padded){this.$body.addClass('oo-ui-popupWidget-body-padded')}
if(config.head){this.closeButton=new OO.ui.ButtonWidget({framed:!1,icon:'close'});this.closeButton.connect(this,{click:'onCloseButtonClick'});this.$head=$('<div>').addClass('oo-ui-popupWidget-head').append(this.$label,this.closeButton.$element);this.$popup.prepend(this.$head)}
if(config.$footer){this.$footer=$('<div>').addClass('oo-ui-popupWidget-footer').append(config.$footer);this.$popup.append(this.$footer)}
this.visible=!1;this.$element.addClass('oo-ui-element-hidden')};OO.inheritClass(OO.ui.PopupWidget,OO.ui.Widget);OO.mixinClass(OO.ui.PopupWidget,OO.ui.mixin.LabelElement);OO.mixinClass(OO.ui.PopupWidget,OO.ui.mixin.ClippableElement);OO.mixinClass(OO.ui.PopupWidget,OO.ui.mixin.FloatableElement);OO.ui.PopupWidget.prototype.onMouseDown=function(e){if(this.isVisible()&&!OO.ui.contains(this.$element.add(this.$autoCloseIgnore).get(),e.target,!0)){this.toggle(!1)}};OO.ui.PopupWidget.prototype.bindMouseDownListener=function(){this.getElementWindow().addEventListener('mousedown',this.onMouseDownHandler,!0)};OO.ui.PopupWidget.prototype.onCloseButtonClick=function(){if(this.isVisible()){this.toggle(!1)}};OO.ui.PopupWidget.prototype.unbindMouseDownListener=function(){this.getElementWindow().removeEventListener('mousedown',this.onMouseDownHandler,!0)};OO.ui.PopupWidget.prototype.onDocumentKeyDown=function(e){if(e.which===OO.ui.Keys.ESCAPE&&this.isVisible()){this.toggle(!1);e.preventDefault();e.stopPropagation()}};OO.ui.PopupWidget.prototype.bindKeyDownListener=function(){this.getElementWindow().addEventListener('keydown',this.onDocumentKeyDownHandler,!0)};OO.ui.PopupWidget.prototype.unbindKeyDownListener=function(){this.getElementWindow().removeEventListener('keydown',this.onDocumentKeyDownHandler,!0)};OO.ui.PopupWidget.prototype.toggleAnchor=function(show){show=show===undefined?!this.anchored:!!show;if(this.anchored!==show){if(show){this.$element.addClass('oo-ui-popupWidget-anchored');this.$element.addClass('oo-ui-popupWidget-anchored-'+this.anchorEdge)}else{this.$element.removeClass('oo-ui-popupWidget-anchored');this.$element.removeClass('oo-ui-popupWidget-anchored-'+this.anchorEdge)}
this.anchored=show}};OO.ui.PopupWidget.prototype.setAnchorEdge=function(edge){if(['top','bottom','start','end'].indexOf(edge)===-1){throw new Error('Invalid value for edge: '+edge)}
if(this.anchorEdge!==null){this.$element.removeClass('oo-ui-popupWidget-anchored-'+this.anchorEdge)}
this.anchorEdge=edge;if(this.anchored){this.$element.addClass('oo-ui-popupWidget-anchored-'+edge)}};OO.ui.PopupWidget.prototype.hasAnchor=function(){return this.anchored};OO.ui.PopupWidget.prototype.toggle=function(show){var change,normalHeight,oppositeHeight,normalWidth,oppositeWidth;show=show===undefined?!this.isVisible():!!show;change=show!==this.isVisible();if(show&&!this.warnedUnattached&&!this.isElementAttached()){OO.ui.warnDeprecation('PopupWidget#toggle: Before calling this method, the popup must be attached to the DOM.');this.warnedUnattached=!0}
if(show&&!this.$floatableContainer&&this.isElementAttached()){this.setFloatableContainer(this.$element.parent())}
if(change&&show&&this.autoFlip){this.isAutoFlipped=!1}
OO.ui.PopupWidget.parent.prototype.toggle.call(this,show);if(change){this.togglePositioning(show&&!!this.$floatableContainer);if(show){if(this.autoClose){this.bindMouseDownListener();this.bindKeyDownListener()}
this.updateDimensions();this.toggleClipping(!0);if(this.autoFlip){if(this.popupPosition==='above'||this.popupPosition==='below'){if(this.isClippedVertically()||this.isFloatableOutOfView()){normalHeight=this.$element.height();this.isAutoFlipped=!this.isAutoFlipped;this.position();if(this.isClippedVertically()||this.isFloatableOutOfView()){oppositeHeight=this.$element.height();if(oppositeHeight<normalHeight){this.isAutoFlipped=!this.isAutoFlipped;this.position()}}}}
if(this.popupPosition==='before'||this.popupPosition==='after'){if(this.isClippedHorizontally()||this.isFloatableOutOfView()){normalWidth=this.$element.width();this.isAutoFlipped=!this.isAutoFlipped;this.toggleClipping(!1);this.position();this.toggleClipping(!0);if(this.isClippedHorizontally()||this.isFloatableOutOfView()){oppositeWidth=this.$element.width();if(oppositeWidth<normalWidth){this.isAutoFlipped=!this.isAutoFlipped;this.toggleClipping(!1);this.position();this.toggleClipping(!0)}}}}}
this.emit('ready')}else{this.toggleClipping(!1);if(this.autoClose){this.unbindMouseDownListener();this.unbindKeyDownListener()}}}
return this};OO.ui.PopupWidget.prototype.setSize=function(width,height,transition){this.width=width;this.height=height!==undefined?height:null;if(this.isVisible()){this.updateDimensions(transition)}};OO.ui.PopupWidget.prototype.updateDimensions=function(transition){var widget=this;clearTimeout(this.transitionTimeout);if(transition){this.$element.addClass('oo-ui-popupWidget-transitioning')}
this.position();if(transition){this.transitionTimeout=setTimeout(function(){widget.$element.removeClass('oo-ui-popupWidget-transitioning')},200)}else{this.$element.removeClass('oo-ui-popupWidget-transitioning')}};OO.ui.PopupWidget.prototype.computePosition=function(){var direction,align,vertical,start,end,near,far,sizeProp,popupSize,anchorSize,anchorPos,anchorOffset,anchorMargin,parentPosition,positionProp,positionAdjustment,floatablePos,offsetParentPos,containerPos,popupPosition,viewportSpacing,popupPos={},anchorCss={left:'',right:'',top:'',bottom:''},popupPositionOppositeMap={above:'below',below:'above',before:'after',after:'before'},alignMap={ltr:{'force-left':'backwards','force-right':'forwards'},rtl:{'force-left':'forwards','force-right':'backwards'}},anchorEdgeMap={above:'bottom',below:'top',before:'end',after:'start'},hPosMap={forwards:'start',center:'center',backwards:this.anchored?'before':'end'},vPosMap={forwards:'top',center:'center',backwards:'bottom'};if(!this.$container){this.$container=$(this.getClosestScrollableElementContainer())}
direction=this.$container.css('direction');this.$popup.css({width:this.width,height:this.height!==null?this.height:'auto'});align=alignMap[direction][this.align]||this.align;popupPosition=this.popupPosition;if(this.isAutoFlipped){popupPosition=popupPositionOppositeMap[popupPosition]}
vertical=popupPosition==='before'||popupPosition==='after';start=vertical?'top':(direction==='rtl'?'right':'left');end=vertical?'bottom':(direction==='rtl'?'left':'right');near=vertical?'top':'left';far=vertical?'bottom':'right';sizeProp=vertical?'Height':'Width';popupSize=vertical?(this.height||this.$popup.height()):this.width;this.setAnchorEdge(anchorEdgeMap[popupPosition]);this.horizontalPosition=vertical?popupPosition:hPosMap[align];this.verticalPosition=vertical?vPosMap[align]:popupPosition;parentPosition=OO.ui.mixin.FloatableElement.prototype.computePosition.call(this);positionProp=vertical?(parentPosition.top!==''?'top':'bottom'):(parentPosition.left!==''?'left':'right');floatablePos=this.$floatableContainer.offset();floatablePos[far]=floatablePos[near]+this.$floatableContainer['outer'+sizeProp]();offsetParentPos=this.$element.offsetParent()[0]===document.documentElement?{top:0,left:0}:this.$element.offsetParent().offset();if(positionProp===near){popupPos[near]=offsetParentPos[near]+parentPosition[near];popupPos[far]=popupPos[near]+popupSize}else{popupPos[far]=offsetParentPos[near]+this.$element.offsetParent()['inner'+sizeProp]()-parentPosition[far];popupPos[near]=popupPos[far]-popupSize}
if(this.anchored){anchorPos=(floatablePos[start]+floatablePos[end])/2;anchorOffset=(start===far?-1:1)*(anchorPos-popupPos[start]);anchorSize=this.$anchor[0]['scroll'+sizeProp];anchorMargin=parseFloat(this.$anchor.css('margin-'+start));if(anchorOffset+anchorMargin<2*anchorSize){positionAdjustment=(positionProp===start?-1:1)*(2*anchorSize-(anchorOffset+anchorMargin))}else if(anchorOffset+anchorMargin>popupSize-2*anchorSize){positionAdjustment=(positionProp===end?-1:1)*(anchorOffset+anchorMargin-(popupSize-2*anchorSize))}else{positionAdjustment=0}}else{positionAdjustment=0}
containerPos=this.$container[0]===document.documentElement?{top:0,left:0}:this.$container.offset();containerPos[far]=containerPos[near]+this.$container['inner'+sizeProp]();if(this.$container[0]===document.documentElement){viewportSpacing=OO.ui.getViewportSpacing();containerPos[near]+=viewportSpacing[near];containerPos[far]-=viewportSpacing[far]}
popupPos[near]+=(positionProp===near?1:-1)*positionAdjustment;popupPos[far]+=(positionProp===near?1:-1)*positionAdjustment;if(containerPos[near]+this.containerPadding>popupPos[near]){positionAdjustment+=(positionProp===near?1:-1)*(containerPos[near]+this.containerPadding-popupPos[near])}else if(containerPos[far]-this.containerPadding<popupPos[far]){positionAdjustment+=(positionProp===far?1:-1)*(popupPos[far]-(containerPos[far]-this.containerPadding))}
if(this.anchored){anchorOffset+=(positionProp===start?-1:1)*positionAdjustment;anchorCss[start]=anchorOffset;this.$anchor.css(anchorCss)}
parentPosition[positionProp]+=positionAdjustment;return parentPosition};OO.ui.PopupWidget.prototype.setAlignment=function(align){if(['force-left','force-right','backwards','forwards','center'].indexOf(align)>-1){this.align=align}else{this.align='center'}
this.position()};OO.ui.PopupWidget.prototype.getAlignment=function(){return this.align};OO.ui.PopupWidget.prototype.setPosition=function(position){if(['above','below','before','after'].indexOf(position)===-1){position='below'}
this.popupPosition=position;this.position()};OO.ui.PopupWidget.prototype.getPosition=function(){return this.popupPosition};OO.ui.PopupWidget.prototype.setAutoFlip=function(autoFlip){autoFlip=!!autoFlip;if(this.autoFlip!==autoFlip){this.autoFlip=autoFlip}};OO.ui.PopupWidget.prototype.getBodyId=function(){var id=this.$body.attr('id');if(id===undefined){id=OO.ui.generateElementId();this.$body.attr('id',id)}
return id};OO.ui.mixin.PopupElement=function OoUiMixinPopupElement(config){config=config||{};this.popup=new OO.ui.PopupWidget($.extend({autoClose:!0,$floatableContainer:this.$element},config.popup,{$autoCloseIgnore:this.$element.add(config.popup&&config.popup.$autoCloseIgnore)}))};OO.ui.mixin.PopupElement.prototype.getPopup=function(){return this.popup};OO.ui.PopupButtonWidget=function OoUiPopupButtonWidget(config){config=config||{};OO.ui.PopupButtonWidget.parent.call(this,config);OO.ui.mixin.PopupElement.call(this,config);this.$overlay=(config.$overlay===!0?OO.ui.getDefaultOverlay():config.$overlay)||this.$element;this.connect(this,{click:'onAction'});this.$element.addClass('oo-ui-popupButtonWidget').attr('aria-haspopup','true');this.popup.$element.addClass('oo-ui-popupButtonWidget-popup').toggleClass('oo-ui-popupButtonWidget-framed-popup',this.isFramed()).toggleClass('oo-ui-popupButtonWidget-frameless-popup',!this.isFramed());this.$overlay.append(this.popup.$element)};OO.inheritClass(OO.ui.PopupButtonWidget,OO.ui.ButtonWidget);OO.mixinClass(OO.ui.PopupButtonWidget,OO.ui.mixin.PopupElement);OO.ui.PopupButtonWidget.prototype.onAction=function(){this.popup.toggle()};OO.ui.mixin.GroupWidget=function OoUiMixinGroupWidget(config){OO.ui.mixin.GroupElement.call(this,config)};OO.mixinClass(OO.ui.mixin.GroupWidget,OO.ui.mixin.GroupElement);OO.ui.mixin.GroupWidget.prototype.setDisabled=function(disabled){var i,len;OO.ui.Widget.prototype.setDisabled.call(this,disabled);if(this.items){for(i=0,len=this.items.length;i<len;i++){this.items[i].updateDisabled()}}
return this};OO.ui.mixin.ItemWidget=function OoUiMixinItemWidget(){};OO.ui.mixin.ItemWidget.prototype.isDisabled=function(){return this.disabled||(this.elementGroup instanceof OO.ui.Widget&&this.elementGroup.isDisabled())};OO.ui.mixin.ItemWidget.prototype.setElementGroup=function(group){OO.ui.Element.prototype.setElementGroup.call(this,group);this.updateDisabled();return this};OO.ui.OptionWidget=function OoUiOptionWidget(config){config=config||{};OO.ui.OptionWidget.parent.call(this,config);OO.ui.mixin.ItemWidget.call(this);OO.ui.mixin.LabelElement.call(this,config);OO.ui.mixin.FlaggedElement.call(this,config);OO.ui.mixin.AccessKeyedElement.call(this,config);this.selected=!1;this.highlighted=!1;this.pressed=!1;this.$element.data('oo-ui-optionWidget',this).attr('tabindex','-1').attr('role','option').attr('aria-selected','false').addClass('oo-ui-optionWidget').append(this.$label)};OO.inheritClass(OO.ui.OptionWidget,OO.ui.Widget);OO.mixinClass(OO.ui.OptionWidget,OO.ui.mixin.ItemWidget);OO.mixinClass(OO.ui.OptionWidget,OO.ui.mixin.LabelElement);OO.mixinClass(OO.ui.OptionWidget,OO.ui.mixin.FlaggedElement);OO.mixinClass(OO.ui.OptionWidget,OO.ui.mixin.AccessKeyedElement);OO.ui.OptionWidget.static.selectable=!0;OO.ui.OptionWidget.static.highlightable=!0;OO.ui.OptionWidget.static.pressable=!0;OO.ui.OptionWidget.static.scrollIntoViewOnSelect=!1;OO.ui.OptionWidget.prototype.isSelectable=function(){return this.constructor.static.selectable&&!this.disabled&&this.isVisible()};OO.ui.OptionWidget.prototype.isHighlightable=function(){return this.constructor.static.highlightable&&!this.disabled&&this.isVisible()};OO.ui.OptionWidget.prototype.isPressable=function(){return this.constructor.static.pressable&&!this.disabled&&this.isVisible()};OO.ui.OptionWidget.prototype.isSelected=function(){return this.selected};OO.ui.OptionWidget.prototype.isHighlighted=function(){return this.highlighted};OO.ui.OptionWidget.prototype.isPressed=function(){return this.pressed};OO.ui.OptionWidget.prototype.setSelected=function(state){if(this.constructor.static.selectable){this.selected=!!state;this.$element.toggleClass('oo-ui-optionWidget-selected',state).attr('aria-selected',state.toString());if(state&&this.constructor.static.scrollIntoViewOnSelect){this.scrollElementIntoView()}
this.updateThemeClasses()}
return this};OO.ui.OptionWidget.prototype.setHighlighted=function(state){if(this.constructor.static.highlightable){this.highlighted=!!state;this.$element.toggleClass('oo-ui-optionWidget-highlighted',state);this.updateThemeClasses()}
return this};OO.ui.OptionWidget.prototype.setPressed=function(state){if(this.constructor.static.pressable){this.pressed=!!state;this.$element.toggleClass('oo-ui-optionWidget-pressed',state);this.updateThemeClasses()}
return this};OO.ui.OptionWidget.prototype.getMatchText=function(){var label=this.getLabel();return typeof label==='string'?label:this.$label.text()};OO.ui.SelectWidget=function OoUiSelectWidget(config){config=config||{};OO.ui.SelectWidget.parent.call(this,config);OO.ui.mixin.GroupWidget.call(this,$.extend({},config,{$group:this.$element}));this.pressed=!1;this.selecting=null;this.onMouseUpHandler=this.onMouseUp.bind(this);this.onMouseMoveHandler=this.onMouseMove.bind(this);this.onKeyDownHandler=this.onKeyDown.bind(this);this.onKeyPressHandler=this.onKeyPress.bind(this);this.keyPressBuffer='';this.keyPressBufferTimer=null;this.blockMouseOverEvents=0;this.connect(this,{toggle:'onToggle'});this.$element.on({focusin:this.onFocus.bind(this),mousedown:this.onMouseDown.bind(this),mouseover:this.onMouseOver.bind(this),mouseleave:this.onMouseLeave.bind(this)});this.$element.addClass('oo-ui-selectWidget oo-ui-selectWidget-depressed').attr('role','listbox');this.setFocusOwner(this.$element);if(Array.isArray(config.items)){this.addItems(config.items)}};OO.inheritClass(OO.ui.SelectWidget,OO.ui.Widget);OO.mixinClass(OO.ui.SelectWidget,OO.ui.mixin.GroupWidget);OO.ui.SelectWidget.prototype.onFocus=function(event){var item;if(event.target===this.$element[0]){if(!this.findSelectedItem()){item=this.findFirstSelectableItem()}}else{if(event.target.tabIndex===-1){item=this.findTargetItem(event)}else{return}}
if(item){if(item.constructor.static.highlightable){this.highlightItem(item)}else{this.selectItem(item)}}
if(event.target!==this.$element[0]){this.$focusOwner.focus()}};OO.ui.SelectWidget.prototype.onMouseDown=function(e){var item;if(!this.isDisabled()&&e.which===OO.ui.MouseButtons.LEFT){this.togglePressed(!0);item=this.findTargetItem(e);if(item&&item.isSelectable()){this.pressItem(item);this.selecting=item;this.getElementDocument().addEventListener('mouseup',this.onMouseUpHandler,!0);this.getElementDocument().addEventListener('mousemove',this.onMouseMoveHandler,!0)}}
return!1};OO.ui.SelectWidget.prototype.onMouseUp=function(e){var item;this.togglePressed(!1);if(!this.selecting){item=this.findTargetItem(e);if(item&&item.isSelectable()){this.selecting=item}}
if(!this.isDisabled()&&e.which===OO.ui.MouseButtons.LEFT&&this.selecting){this.pressItem(null);this.chooseItem(this.selecting);this.selecting=null}
this.getElementDocument().removeEventListener('mouseup',this.onMouseUpHandler,!0);this.getElementDocument().removeEventListener('mousemove',this.onMouseMoveHandler,!0);return!1};OO.ui.SelectWidget.prototype.onMouseMove=function(e){var item;if(!this.isDisabled()&&this.pressed){item=this.findTargetItem(e);if(item&&item!==this.selecting&&item.isSelectable()){this.pressItem(item);this.selecting=item}}};OO.ui.SelectWidget.prototype.onMouseOver=function(e){var item;if(this.blockMouseOverEvents){return}
if(!this.isDisabled()){item=this.findTargetItem(e);this.highlightItem(item&&item.isHighlightable()?item:null)}
return!1};OO.ui.SelectWidget.prototype.onMouseLeave=function(){if(!this.isDisabled()){this.highlightItem(null)}
return!1};OO.ui.SelectWidget.prototype.onKeyDown=function(e){var nextItem,handled=!1,currentItem=this.findHighlightedItem()||this.findSelectedItem();if(!this.isDisabled()&&this.isVisible()){switch(e.keyCode){case OO.ui.Keys.ENTER:if(currentItem&&currentItem.constructor.static.highlightable){this.chooseItem(currentItem);handled=!0}
break;case OO.ui.Keys.UP:case OO.ui.Keys.LEFT:this.clearKeyPressBuffer();nextItem=this.findRelativeSelectableItem(currentItem,-1);handled=!0;break;case OO.ui.Keys.DOWN:case OO.ui.Keys.RIGHT:this.clearKeyPressBuffer();nextItem=this.findRelativeSelectableItem(currentItem,1);handled=!0;break;case OO.ui.Keys.ESCAPE:case OO.ui.Keys.TAB:if(currentItem&&currentItem.constructor.static.highlightable){currentItem.setHighlighted(!1)}
this.unbindKeyDownListener();this.unbindKeyPressListener();handled=!1;break}
if(nextItem){if(nextItem.constructor.static.highlightable){this.highlightItem(nextItem)}else{this.chooseItem(nextItem)}
this.scrollItemIntoView(nextItem)}
if(handled){e.preventDefault();e.stopPropagation()}}};OO.ui.SelectWidget.prototype.bindKeyDownListener=function(){this.getElementWindow().addEventListener('keydown',this.onKeyDownHandler,!0)};OO.ui.SelectWidget.prototype.unbindKeyDownListener=function(){this.getElementWindow().removeEventListener('keydown',this.onKeyDownHandler,!0)};OO.ui.SelectWidget.prototype.scrollItemIntoView=function(item){var widget=this;this.blockMouseOverEvents++;item.scrollElementIntoView().done(function(){setTimeout(function(){widget.blockMouseOverEvents--},200)})};OO.ui.SelectWidget.prototype.clearKeyPressBuffer=function(){if(this.keyPressBufferTimer){clearTimeout(this.keyPressBufferTimer);this.keyPressBufferTimer=null}
this.keyPressBuffer=''};OO.ui.SelectWidget.prototype.onKeyPress=function(e){var c,filter,item;if(!e.charCode){if(e.keyCode===OO.ui.Keys.BACKSPACE&&this.keyPressBuffer!==''){this.keyPressBuffer=this.keyPressBuffer.substr(0,this.keyPressBuffer.length-1);return!1}
return}
if(String.fromCodePoint){c=String.fromCodePoint(e.charCode)}else{c=String.fromCharCode(e.charCode)}
if(this.keyPressBufferTimer){clearTimeout(this.keyPressBufferTimer)}
this.keyPressBufferTimer=setTimeout(this.clearKeyPressBuffer.bind(this),1500);item=this.findHighlightedItem()||this.findSelectedItem();if(this.keyPressBuffer===c){if(item){item=this.findRelativeSelectableItem(item,1)}}else{this.keyPressBuffer+=c}
filter=this.getItemMatcher(this.keyPressBuffer,!1);if(!item||!filter(item)){item=this.findRelativeSelectableItem(item,1,filter)}
if(item){if(this.isVisible()&&item.constructor.static.highlightable){this.highlightItem(item)}else{this.chooseItem(item)}
this.scrollItemIntoView(item)}
e.preventDefault();e.stopPropagation()};OO.ui.SelectWidget.prototype.getItemMatcher=function(s,exact){var re;if(s.normalize){s=s.normalize()}
s=exact?s.trim():s.replace(/^\s+/,'');re='^\\s*'+s.replace(/([\\{}()|.?*+\-^$[\]])/g,'\\$1').replace(/\s+/g,'\\s+');if(exact){re+='\\s*$'}
re=new RegExp(re,'i');return function(item){var matchText=item.getMatchText();if(matchText.normalize){matchText=matchText.normalize()}
return re.test(matchText)}};OO.ui.SelectWidget.prototype.bindKeyPressListener=function(){this.getElementWindow().addEventListener('keypress',this.onKeyPressHandler,!0)};OO.ui.SelectWidget.prototype.unbindKeyPressListener=function(){this.getElementWindow().removeEventListener('keypress',this.onKeyPressHandler,!0);this.clearKeyPressBuffer()};OO.ui.SelectWidget.prototype.onToggle=function(visible){if(!visible){this.clearKeyPressBuffer()}};OO.ui.SelectWidget.prototype.findTargetItem=function(e){var $option=$(e.target).closest('.oo-ui-optionWidget');if(!$option.closest('.oo-ui-selectWidget').is(this.$element)){return null}
return $option.data('oo-ui-optionWidget')||null};OO.ui.SelectWidget.prototype.findSelectedItem=function(){var i,len;for(i=0,len=this.items.length;i<len;i++){if(this.items[i].isSelected()){return this.items[i]}}
return null};OO.ui.SelectWidget.prototype.getSelectedItem=function(){OO.ui.warnDeprecation('SelectWidget#getSelectedItem: Deprecated function. Use findSelectedItem instead. See T76630.');return this.findSelectedItem()};OO.ui.SelectWidget.prototype.findHighlightedItem=function(){var i,len;for(i=0,len=this.items.length;i<len;i++){if(this.items[i].isHighlighted()){return this.items[i]}}
return null};OO.ui.SelectWidget.prototype.togglePressed=function(pressed){if(pressed===undefined){pressed=!this.pressed}
if(pressed!==this.pressed){this.$element.toggleClass('oo-ui-selectWidget-pressed',pressed).toggleClass('oo-ui-selectWidget-depressed',!pressed);this.pressed=pressed}};OO.ui.SelectWidget.prototype.highlightItem=function(item){var i,len,highlighted,changed=!1;for(i=0,len=this.items.length;i<len;i++){highlighted=this.items[i]===item;if(this.items[i].isHighlighted()!==highlighted){this.items[i].setHighlighted(highlighted);changed=!0}}
if(changed){if(item){this.$focusOwner.attr('aria-activedescendant',item.getElementId())}else{this.$focusOwner.removeAttr('aria-activedescendant')}
this.emit('highlight',item)}
return this};OO.ui.SelectWidget.prototype.getItemFromLabel=function(label,prefix){var i,item,found,len=this.items.length,filter=this.getItemMatcher(label,!0);for(i=0;i<len;i++){item=this.items[i];if(item instanceof OO.ui.OptionWidget&&item.isSelectable()&&filter(item)){return item}}
if(prefix){found=null;filter=this.getItemMatcher(label,!1);for(i=0;i<len;i++){item=this.items[i];if(item instanceof OO.ui.OptionWidget&&item.isSelectable()&&filter(item)){if(found){return null}
found=item}}
if(found){return found}}
return null};OO.ui.SelectWidget.prototype.selectItemByLabel=function(label,prefix){var itemFromLabel=this.getItemFromLabel(label,!!prefix);if(label===undefined||!itemFromLabel){return this.selectItem()}
return this.selectItem(itemFromLabel)};OO.ui.SelectWidget.prototype.selectItemByData=function(data){var itemFromData=this.findItemFromData(data);if(data===undefined||!itemFromData){return this.selectItem()}
return this.selectItem(itemFromData)};OO.ui.SelectWidget.prototype.selectItem=function(item){var i,len,selected,changed=!1;for(i=0,len=this.items.length;i<len;i++){selected=this.items[i]===item;if(this.items[i].isSelected()!==selected){this.items[i].setSelected(selected);changed=!0}}
if(changed){if(item&&!item.constructor.static.highlightable){if(item){this.$focusOwner.attr('aria-activedescendant',item.getElementId())}else{this.$focusOwner.removeAttr('aria-activedescendant')}}
this.emit('select',item)}
return this};OO.ui.SelectWidget.prototype.pressItem=function(item){var i,len,pressed,changed=!1;for(i=0,len=this.items.length;i<len;i++){pressed=this.items[i]===item;if(this.items[i].isPressed()!==pressed){this.items[i].setPressed(pressed);changed=!0}}
if(changed){this.emit('press',item)}
return this};OO.ui.SelectWidget.prototype.chooseItem=function(item){if(item){this.selectItem(item);this.emit('choose',item)}
return this};OO.ui.SelectWidget.prototype.findRelativeSelectableItem=function(item,direction,filter){var currentIndex,nextIndex,i,increase=direction>0?1:-1,len=this.items.length;if(item instanceof OO.ui.OptionWidget){currentIndex=this.items.indexOf(item);nextIndex=(currentIndex+increase+len)%len}else{nextIndex=direction>0?0:len-1}
for(i=0;i<len;i++){item=this.items[nextIndex];if(item instanceof OO.ui.OptionWidget&&item.isSelectable()&&(!filter||filter(item))){return item}
nextIndex=(nextIndex+increase+len)%len}
return null};OO.ui.SelectWidget.prototype.findFirstSelectableItem=function(){return this.findRelativeSelectableItem(null,1)};OO.ui.SelectWidget.prototype.addItems=function(items,index){OO.ui.mixin.GroupWidget.prototype.addItems.call(this,items,index);this.emit('add',items,index===undefined?this.items.length-items.length-1:index);return this};OO.ui.SelectWidget.prototype.removeItems=function(items){var i,len,item;for(i=0,len=items.length;i<len;i++){item=items[i];if(item.isSelected()){this.selectItem(null)}}
OO.ui.mixin.GroupWidget.prototype.removeItems.call(this,items);this.emit('remove',items);return this};OO.ui.SelectWidget.prototype.clearItems=function(){var items=this.items.slice();OO.ui.mixin.GroupWidget.prototype.clearItems.call(this);this.selectItem(null);this.emit('remove',items);return this};OO.ui.SelectWidget.prototype.setFocusOwner=function($focusOwner){this.$focusOwner=$focusOwner};OO.ui.DecoratedOptionWidget=function OoUiDecoratedOptionWidget(config){OO.ui.DecoratedOptionWidget.parent.call(this,config);OO.ui.mixin.IconElement.call(this,config);OO.ui.mixin.IndicatorElement.call(this,config);this.$element.addClass('oo-ui-decoratedOptionWidget').prepend(this.$icon).append(this.$indicator)};OO.inheritClass(OO.ui.DecoratedOptionWidget,OO.ui.OptionWidget);OO.mixinClass(OO.ui.DecoratedOptionWidget,OO.ui.mixin.IconElement);OO.mixinClass(OO.ui.DecoratedOptionWidget,OO.ui.mixin.IndicatorElement);OO.ui.MenuOptionWidget=function OoUiMenuOptionWidget(config){OO.ui.MenuOptionWidget.parent.call(this,config);this.$element.addClass('oo-ui-menuOptionWidget')};OO.inheritClass(OO.ui.MenuOptionWidget,OO.ui.DecoratedOptionWidget);OO.ui.MenuOptionWidget.static.scrollIntoViewOnSelect=!0;OO.ui.MenuSectionOptionWidget=function OoUiMenuSectionOptionWidget(config){OO.ui.MenuSectionOptionWidget.parent.call(this,config);this.$element.addClass('oo-ui-menuSectionOptionWidget').removeAttr('role aria-selected')};OO.inheritClass(OO.ui.MenuSectionOptionWidget,OO.ui.DecoratedOptionWidget);OO.ui.MenuSectionOptionWidget.static.selectable=!1;OO.ui.MenuSectionOptionWidget.static.highlightable=!1;OO.ui.MenuSelectWidget=function OoUiMenuSelectWidget(config){config=config||{};OO.ui.MenuSelectWidget.parent.call(this,config);OO.ui.mixin.ClippableElement.call(this,$.extend({},config,{$clippable:this.$group}));OO.ui.mixin.FloatableElement.call(this,config);this.autoHide=config.autoHide===undefined||!!config.autoHide;this.hideOnChoose=config.hideOnChoose===undefined||!!config.hideOnChoose;this.filterFromInput=!!config.filterFromInput;this.$input=config.$input?config.$input:config.input?config.input.$input:null;this.$widget=config.widget?config.widget.$element:null;this.$autoCloseIgnore=config.$autoCloseIgnore||$([]);this.onDocumentMouseDownHandler=this.onDocumentMouseDown.bind(this);this.onInputEditHandler=OO.ui.debounce(this.updateItemVisibility.bind(this),100);this.highlightOnFilter=!!config.highlightOnFilter;this.width=config.width;this.$element.addClass('oo-ui-menuSelectWidget');if(config.widget){this.setFocusOwner(config.widget.$tabIndexed)}
this.visible=!1;this.$element.addClass('oo-ui-element-hidden')};OO.inheritClass(OO.ui.MenuSelectWidget,OO.ui.SelectWidget);OO.mixinClass(OO.ui.MenuSelectWidget,OO.ui.mixin.ClippableElement);OO.mixinClass(OO.ui.MenuSelectWidget,OO.ui.mixin.FloatableElement);OO.ui.MenuSelectWidget.prototype.onDocumentMouseDown=function(e){if(this.isVisible()&&!OO.ui.contains(this.$element.add(this.$widget).add(this.$autoCloseIgnore).get(),e.target,!0)){this.toggle(!1)}};OO.ui.MenuSelectWidget.prototype.onKeyDown=function(e){var currentItem=this.findHighlightedItem()||this.findSelectedItem();if(!this.isDisabled()&&this.isVisible()){switch(e.keyCode){case OO.ui.Keys.LEFT:case OO.ui.Keys.RIGHT:if(!this.$input){OO.ui.MenuSelectWidget.parent.prototype.onKeyDown.call(this,e)}
break;case OO.ui.Keys.ESCAPE:case OO.ui.Keys.TAB:if(currentItem){currentItem.setHighlighted(!1)}
this.toggle(!1);if(e.keyCode===OO.ui.Keys.ESCAPE){e.preventDefault();e.stopPropagation()}
break;default:OO.ui.MenuSelectWidget.parent.prototype.onKeyDown.call(this,e);return}}};OO.ui.MenuSelectWidget.prototype.updateItemVisibility=function(){var i,item,visible,section,sectionEmpty,filter,exactFilter,firstItemFound=!1,anyVisible=!1,len=this.items.length,showAll=!this.isVisible(),exactMatch=!1;if(this.$input&&this.filterFromInput){filter=showAll?null:this.getItemMatcher(this.$input.val());exactFilter=this.getItemMatcher(this.$input.val(),!0);for(i=0;i<len;i++){item=this.items[i];if(item instanceof OO.ui.MenuSectionOptionWidget){if(section){section.toggle(showAll||!sectionEmpty)}
section=item;sectionEmpty=!0}else if(item instanceof OO.ui.OptionWidget){visible=showAll||filter(item);exactMatch=exactMatch||exactFilter(item);anyVisible=anyVisible||visible;sectionEmpty=sectionEmpty&&!visible;item.toggle(visible);if(this.highlightOnFilter&&visible&&!firstItemFound){this.highlightItem(item);firstItemFound=!0}}}
if(section){section.toggle(showAll||!sectionEmpty)}
if(anyVisible&&this.items.length&&!exactMatch){this.scrollItemIntoView(this.items[0])}
this.$element.toggleClass('oo-ui-menuSelectWidget-invisible',!anyVisible)}
this.clip()};OO.ui.MenuSelectWidget.prototype.bindKeyDownListener=function(){if(this.$input){this.$input.on('keydown',this.onKeyDownHandler)}else{OO.ui.MenuSelectWidget.parent.prototype.bindKeyDownListener.call(this)}};OO.ui.MenuSelectWidget.prototype.unbindKeyDownListener=function(){if(this.$input){this.$input.off('keydown',this.onKeyDownHandler)}else{OO.ui.MenuSelectWidget.parent.prototype.unbindKeyDownListener.call(this)}};OO.ui.MenuSelectWidget.prototype.bindKeyPressListener=function(){if(this.$input){if(this.filterFromInput){this.$input.on('keydown mouseup cut paste change input select',this.onInputEditHandler);this.updateItemVisibility()}}else{OO.ui.MenuSelectWidget.parent.prototype.bindKeyPressListener.call(this)}};OO.ui.MenuSelectWidget.prototype.unbindKeyPressListener=function(){if(this.$input){if(this.filterFromInput){this.$input.off('keydown mouseup cut paste change input select',this.onInputEditHandler);this.updateItemVisibility()}}else{OO.ui.MenuSelectWidget.parent.prototype.unbindKeyPressListener.call(this)}};OO.ui.MenuSelectWidget.prototype.chooseItem=function(item){OO.ui.MenuSelectWidget.parent.prototype.chooseItem.call(this,item);if(this.hideOnChoose){this.toggle(!1)}
return this};OO.ui.MenuSelectWidget.prototype.addItems=function(items,index){OO.ui.MenuSelectWidget.parent.prototype.addItems.call(this,items,index);this.updateItemVisibility();return this};OO.ui.MenuSelectWidget.prototype.removeItems=function(items){OO.ui.MenuSelectWidget.parent.prototype.removeItems.call(this,items);this.updateItemVisibility();return this};OO.ui.MenuSelectWidget.prototype.clearItems=function(){OO.ui.MenuSelectWidget.parent.prototype.clearItems.call(this);this.updateItemVisibility();return this};OO.ui.MenuSelectWidget.prototype.toggle=function(visible){var change,belowHeight,aboveHeight;visible=(visible===undefined?!this.visible:!!visible)&&!!this.items.length;change=visible!==this.isVisible();if(visible&&!this.warnedUnattached&&!this.isElementAttached()){OO.ui.warnDeprecation('MenuSelectWidget#toggle: Before calling this method, the menu must be attached to the DOM.');this.warnedUnattached=!0}
if(change){if(visible&&(this.width||this.$floatableContainer)){this.setIdealSize(this.width||this.$floatableContainer.width())}
if(visible){this.setVerticalPosition('below')}}
OO.ui.MenuSelectWidget.parent.prototype.toggle.call(this,visible);if(change){if(visible){this.bindKeyDownListener();this.bindKeyPressListener();this.togglePositioning(!!this.$floatableContainer);this.toggleClipping(!0);if(this.isClippedVertically()||this.isFloatableOutOfView()){belowHeight=this.$element.height();this.setVerticalPosition('above');if(this.isClippedVertically()||this.isFloatableOutOfView()){aboveHeight=this.$element.height();if(aboveHeight<belowHeight){this.setVerticalPosition('below')}}}
this.$focusOwner.attr('aria-expanded','true');if(this.findSelectedItem()){this.$focusOwner.attr('aria-activedescendant',this.findSelectedItem().getElementId());this.findSelectedItem().scrollElementIntoView({duration:0})}
if(this.autoHide){this.getElementDocument().addEventListener('mousedown',this.onDocumentMouseDownHandler,!0)}
this.emit('ready')}else{this.$focusOwner.removeAttr('aria-activedescendant');this.unbindKeyDownListener();this.unbindKeyPressListener();this.$focusOwner.attr('aria-expanded','false');this.getElementDocument().removeEventListener('mousedown',this.onDocumentMouseDownHandler,!0);this.togglePositioning(!1);this.toggleClipping(!1)}}
return this};OO.ui.DropdownWidget=function OoUiDropdownWidget(config){config=$.extend({indicator:'down'},config);OO.ui.DropdownWidget.parent.call(this,config);this.$handle=$('<span>');this.$overlay=(config.$overlay===!0?OO.ui.getDefaultOverlay():config.$overlay)||this.$element;OO.ui.mixin.IconElement.call(this,config);OO.ui.mixin.IndicatorElement.call(this,config);OO.ui.mixin.LabelElement.call(this,config);OO.ui.mixin.TitledElement.call(this,$.extend({},config,{$titled:this.$label}));OO.ui.mixin.TabIndexedElement.call(this,$.extend({},config,{$tabIndexed:this.$handle}));this.menu=new OO.ui.MenuSelectWidget($.extend({widget:this,$floatableContainer:this.$element},config.menu));this.$handle.on({click:this.onClick.bind(this),keydown:this.onKeyDown.bind(this),keypress:this.menu.onKeyPressHandler,blur:this.menu.clearKeyPressBuffer.bind(this.menu)});this.menu.connect(this,{select:'onMenuSelect',toggle:'onMenuToggle'});this.$handle.addClass('oo-ui-dropdownWidget-handle').attr({role:'combobox','aria-owns':this.menu.getElementId(),'aria-autocomplete':'list'}).append(this.$icon,this.$label,this.$indicator);this.$element.addClass('oo-ui-dropdownWidget').append(this.$handle);this.$overlay.append(this.menu.$element)};OO.inheritClass(OO.ui.DropdownWidget,OO.ui.Widget);OO.mixinClass(OO.ui.DropdownWidget,OO.ui.mixin.IconElement);OO.mixinClass(OO.ui.DropdownWidget,OO.ui.mixin.IndicatorElement);OO.mixinClass(OO.ui.DropdownWidget,OO.ui.mixin.LabelElement);OO.mixinClass(OO.ui.DropdownWidget,OO.ui.mixin.TitledElement);OO.mixinClass(OO.ui.DropdownWidget,OO.ui.mixin.TabIndexedElement);OO.ui.DropdownWidget.prototype.getMenu=function(){return this.menu};OO.ui.DropdownWidget.prototype.onMenuSelect=function(item){var selectedLabel;if(!item){this.setLabel(null);return}
selectedLabel=item.getLabel();if(selectedLabel instanceof jQuery){selectedLabel=selectedLabel.clone()}
this.setLabel(selectedLabel)};OO.ui.DropdownWidget.prototype.onMenuToggle=function(isVisible){this.$element.toggleClass('oo-ui-dropdownWidget-open',isVisible);this.$handle.attr('aria-expanded',this.$element.hasClass('oo-ui-dropdownWidget-open').toString())};OO.ui.DropdownWidget.prototype.onClick=function(e){if(!this.isDisabled()&&e.which===OO.ui.MouseButtons.LEFT){this.menu.toggle()}
return!1};OO.ui.DropdownWidget.prototype.onKeyDown=function(e){if(!this.isDisabled()&&(e.which===OO.ui.Keys.ENTER||(e.which===OO.ui.Keys.SPACE&&this.menu.keyPressBuffer==='')||(!this.menu.isVisible()&&(e.which===OO.ui.Keys.UP||e.which===OO.ui.Keys.DOWN)))){this.menu.toggle();return!1}};OO.ui.RadioOptionWidget=function OoUiRadioOptionWidget(config){config=config||{};this.radio=new OO.ui.RadioInputWidget({value:config.data,tabIndex:-1});OO.ui.RadioOptionWidget.parent.call(this,config);this.radio.$input.attr('role','presentation');this.$element.addClass('oo-ui-radioOptionWidget').attr('role','radio').attr('aria-checked','false').removeAttr('aria-selected').prepend(this.radio.$element)};OO.inheritClass(OO.ui.RadioOptionWidget,OO.ui.OptionWidget);OO.ui.RadioOptionWidget.static.highlightable=!1;OO.ui.RadioOptionWidget.static.scrollIntoViewOnSelect=!0;OO.ui.RadioOptionWidget.static.pressable=!1;OO.ui.RadioOptionWidget.static.tagName='label';OO.ui.RadioOptionWidget.prototype.setSelected=function(state){OO.ui.RadioOptionWidget.parent.prototype.setSelected.call(this,state);this.radio.setSelected(state);this.$element.attr('aria-checked',state.toString()).removeAttr('aria-selected');return this};OO.ui.RadioOptionWidget.prototype.setDisabled=function(disabled){OO.ui.RadioOptionWidget.parent.prototype.setDisabled.call(this,disabled);this.radio.setDisabled(this.isDisabled());return this};OO.ui.RadioSelectWidget=function OoUiRadioSelectWidget(config){OO.ui.RadioSelectWidget.parent.call(this,config);OO.ui.mixin.TabIndexedElement.call(this,config);this.$element.on({focus:this.bindKeyDownListener.bind(this),blur:this.unbindKeyDownListener.bind(this)});this.$element.addClass('oo-ui-radioSelectWidget').attr('role','radiogroup')};OO.inheritClass(OO.ui.RadioSelectWidget,OO.ui.SelectWidget);OO.mixinClass(OO.ui.RadioSelectWidget,OO.ui.mixin.TabIndexedElement);OO.ui.MultioptionWidget=function OoUiMultioptionWidget(config){config=config||{};OO.ui.MultioptionWidget.parent.call(this,config);OO.ui.mixin.ItemWidget.call(this);OO.ui.mixin.LabelElement.call(this,config);this.selected=null;this.$element.addClass('oo-ui-multioptionWidget').append(this.$label);this.setSelected(config.selected)};OO.inheritClass(OO.ui.MultioptionWidget,OO.ui.Widget);OO.mixinClass(OO.ui.MultioptionWidget,OO.ui.mixin.ItemWidget);OO.mixinClass(OO.ui.MultioptionWidget,OO.ui.mixin.LabelElement);OO.ui.MultioptionWidget.prototype.isSelected=function(){return this.selected};OO.ui.MultioptionWidget.prototype.setSelected=function(state){state=!!state;if(this.selected!==state){this.selected=state;this.emit('change',state);this.$element.toggleClass('oo-ui-multioptionWidget-selected',state)}
return this};OO.ui.MultiselectWidget=function OoUiMultiselectWidget(config){OO.ui.MultiselectWidget.parent.call(this,config);config=config||{};OO.ui.mixin.GroupWidget.call(this,config);this.aggregate({change:'select'});this.connect(this,{select:['emit','change']});if(config.items){this.addItems(config.items)}
this.$group.addClass('oo-ui-multiselectWidget-group');this.$element.addClass('oo-ui-multiselectWidget').append(this.$group)};OO.inheritClass(OO.ui.MultiselectWidget,OO.ui.Widget);OO.mixinClass(OO.ui.MultiselectWidget,OO.ui.mixin.GroupWidget);OO.ui.MultiselectWidget.prototype.findSelectedItems=function(){return this.items.filter(function(item){return item.isSelected()})};OO.ui.MultiselectWidget.prototype.getSelectedItems=function(){OO.ui.warnDeprecation('MultiselectWidget#getSelectedItems: Deprecated function. Use findSelectedItems instead. See T76630.');return this.findSelectedItems()};OO.ui.MultiselectWidget.prototype.findSelectedItemsData=function(){return this.findSelectedItems().map(function(item){return item.data})};OO.ui.MultiselectWidget.prototype.getSelectedItemsData=function(){OO.ui.warnDeprecation('MultiselectWidget#getSelectedItemsData: Deprecated function. Use findSelectedItemsData instead. See T76630.');return this.findSelectedItemsData()};OO.ui.MultiselectWidget.prototype.selectItems=function(items){this.items.forEach(function(item){var selected=items.indexOf(item)!==-1;item.setSelected(selected)});return this};OO.ui.MultiselectWidget.prototype.selectItemsByData=function(datas){var items,widget=this;items=datas.map(function(data){return widget.findItemFromData(data)});this.selectItems(items);return this};OO.ui.CheckboxMultioptionWidget=function OoUiCheckboxMultioptionWidget(config){config=config||{};this.checkbox=new OO.ui.CheckboxInputWidget();OO.ui.CheckboxMultioptionWidget.parent.call(this,config);this.checkbox.on('change',this.onCheckboxChange.bind(this));this.$element.on('keydown',this.onKeyDown.bind(this));this.$element.addClass('oo-ui-checkboxMultioptionWidget').prepend(this.checkbox.$element)};OO.inheritClass(OO.ui.CheckboxMultioptionWidget,OO.ui.MultioptionWidget);OO.ui.CheckboxMultioptionWidget.static.tagName='label';OO.ui.CheckboxMultioptionWidget.prototype.onCheckboxChange=function(){this.setSelected(this.checkbox.isSelected())};OO.ui.CheckboxMultioptionWidget.prototype.setSelected=function(state){OO.ui.CheckboxMultioptionWidget.parent.prototype.setSelected.call(this,state);this.checkbox.setSelected(state);return this};OO.ui.CheckboxMultioptionWidget.prototype.setDisabled=function(disabled){OO.ui.CheckboxMultioptionWidget.parent.prototype.setDisabled.call(this,disabled);this.checkbox.setDisabled(this.isDisabled());return this};OO.ui.CheckboxMultioptionWidget.prototype.focus=function(){this.checkbox.focus()};OO.ui.CheckboxMultioptionWidget.prototype.onKeyDown=function(e){var
element=this.getElementGroup(),nextItem;if(e.keyCode===OO.ui.Keys.LEFT||e.keyCode===OO.ui.Keys.UP){nextItem=element.getRelativeFocusableItem(this,-1)}else if(e.keyCode===OO.ui.Keys.RIGHT||e.keyCode===OO.ui.Keys.DOWN){nextItem=element.getRelativeFocusableItem(this,1)}
if(nextItem){e.preventDefault();nextItem.focus()}};OO.ui.CheckboxMultiselectWidget=function OoUiCheckboxMultiselectWidget(config){OO.ui.CheckboxMultiselectWidget.parent.call(this,config);this.$lastClicked=null;this.$group.on('click',this.onClick.bind(this));this.$element.addClass('oo-ui-checkboxMultiselectWidget')};OO.inheritClass(OO.ui.CheckboxMultiselectWidget,OO.ui.MultiselectWidget);OO.ui.CheckboxMultiselectWidget.prototype.getRelativeFocusableItem=function(item,direction){var currentIndex,nextIndex,i,increase=direction>0?1:-1,len=this.items.length;if(item){currentIndex=this.items.indexOf(item);nextIndex=(currentIndex+increase+len)%len}else{nextIndex=direction>0?0:len-1}
for(i=0;i<len;i++){item=this.items[nextIndex];if(item&&!item.isDisabled()){return item}
nextIndex=(nextIndex+increase+len)%len}
return null};OO.ui.CheckboxMultiselectWidget.prototype.onClick=function(e){var $options,lastClickedIndex,nowClickedIndex,i,direction,wasSelected,items,$lastClicked=this.$lastClicked,$nowClicked=$(e.target).closest('.oo-ui-checkboxMultioptionWidget').not('.oo-ui-widget-disabled');if($lastClicked&&$nowClicked.length&&e.shiftKey){$options=this.$group.find('.oo-ui-checkboxMultioptionWidget');lastClickedIndex=$options.index($lastClicked);nowClickedIndex=$options.index($nowClicked);if(nowClickedIndex!==lastClickedIndex){items=this.items;wasSelected=items[nowClickedIndex].isSelected();direction=nowClickedIndex>lastClickedIndex?1:-1;for(i=lastClickedIndex;i!==nowClickedIndex;i+=direction){if(!items[i].isDisabled()){items[i].setSelected(!wasSelected)}}
e.preventDefault();setTimeout(function(){if(!items[nowClickedIndex].isDisabled()){items[nowClickedIndex].setSelected(!wasSelected)}})}}
if($nowClicked.length){this.$lastClicked=$nowClicked}};OO.ui.CheckboxMultiselectWidget.prototype.focus=function(){var item;if(!this.isDisabled()){item=this.getRelativeFocusableItem(null,1);if(item){item.focus()}}
return this};OO.ui.CheckboxMultiselectWidget.prototype.simulateLabelClick=function(){this.focus()};OO.ui.ProgressBarWidget=function OoUiProgressBarWidget(config){config=config||{};OO.ui.ProgressBarWidget.parent.call(this,config);this.$bar=$('<div>');this.progress=null;this.setProgress(config.progress!==undefined?config.progress:!1);this.$bar.addClass('oo-ui-progressBarWidget-bar');this.$element.attr({role:'progressbar','aria-valuemin':0,'aria-valuemax':100}).addClass('oo-ui-progressBarWidget').append(this.$bar)};OO.inheritClass(OO.ui.ProgressBarWidget,OO.ui.Widget);OO.ui.ProgressBarWidget.static.tagName='div';OO.ui.ProgressBarWidget.prototype.getProgress=function(){return this.progress};OO.ui.ProgressBarWidget.prototype.setProgress=function(progress){this.progress=progress;if(progress!==!1){this.$bar.css('width',this.progress+'%');this.$element.attr('aria-valuenow',this.progress)}else{this.$bar.css('width','');this.$element.removeAttr('aria-valuenow')}
this.$element.toggleClass('oo-ui-progressBarWidget-indeterminate',progress===!1)};OO.ui.InputWidget=function OoUiInputWidget(config){config=config||{};OO.ui.InputWidget.parent.call(this,config);this.$input=config.$input||this.getInputElement(config);this.value='';this.inputFilter=config.inputFilter;OO.ui.mixin.FlaggedElement.call(this,config);OO.ui.mixin.TabIndexedElement.call(this,$.extend({},config,{$tabIndexed:this.$input}));OO.ui.mixin.TitledElement.call(this,$.extend({},config,{$titled:this.$input}));OO.ui.mixin.AccessKeyedElement.call(this,$.extend({},config,{$accessKeyed:this.$input}));this.$input.on('keydown mouseup cut paste change input select',this.onEdit.bind(this));this.$input.addClass('oo-ui-inputWidget-input').attr('name',config.name).prop('disabled',this.isDisabled());this.$element.addClass('oo-ui-inputWidget').append(this.$input);this.setValue(config.value);if(config.dir){this.setDir(config.dir)}
if(config.inputId!==undefined){this.setInputId(config.inputId)}};OO.inheritClass(OO.ui.InputWidget,OO.ui.Widget);OO.mixinClass(OO.ui.InputWidget,OO.ui.mixin.FlaggedElement);OO.mixinClass(OO.ui.InputWidget,OO.ui.mixin.TabIndexedElement);OO.mixinClass(OO.ui.InputWidget,OO.ui.mixin.TitledElement);OO.mixinClass(OO.ui.InputWidget,OO.ui.mixin.AccessKeyedElement);OO.ui.InputWidget.static.reusePreInfuseDOM=function(node,config){config=OO.ui.InputWidget.parent.static.reusePreInfuseDOM(node,config);config.$input=$(node).find('.oo-ui-inputWidget-input');return config};OO.ui.InputWidget.static.gatherPreInfuseState=function(node,config){var state=OO.ui.InputWidget.parent.static.gatherPreInfuseState(node,config);if(config.$input&&config.$input.length){state.value=config.$input.val();state.focus=config.$input.is(':focus')}
return state};OO.ui.InputWidget.prototype.getInputElement=function(){return $('<input>')};OO.ui.InputWidget.prototype.onEdit=function(){var widget=this;if(!this.isDisabled()){setTimeout(function(){widget.setValue(widget.$input.val())})}};OO.ui.InputWidget.prototype.getValue=function(){var value=this.$input.val();if(this.value!==value){this.setValue(value)}
return this.value};OO.ui.InputWidget.prototype.setDir=function(dir){this.$input.prop('dir',dir);return this};OO.ui.InputWidget.prototype.setValue=function(value){value=this.cleanUpValue(value);if(this.$input.val()!==value){this.$input.val(value)}
if(this.value!==value){this.value=value;this.emit('change',this.value)}
if(this.defaultValue===undefined){this.defaultValue=this.value;this.$input[0].defaultValue=this.defaultValue}
return this};OO.ui.InputWidget.prototype.cleanUpValue=function(value){if(value===undefined||value===null){return''}else if(this.inputFilter){return this.inputFilter(String(value))}else{return String(value)}};OO.ui.InputWidget.prototype.setDisabled=function(state){OO.ui.InputWidget.parent.prototype.setDisabled.call(this,state);if(this.$input){this.$input.prop('disabled',this.isDisabled())}
return this};OO.ui.InputWidget.prototype.setInputId=function(id){this.$input.attr('id',id);return this};OO.ui.InputWidget.prototype.restorePreInfuseState=function(state){OO.ui.InputWidget.parent.prototype.restorePreInfuseState.call(this,state);if(state.value!==undefined&&state.value!==this.getValue()){this.setValue(state.value)}
if(state.focus){this.focus()}};OO.ui.HiddenInputWidget=function OoUiHiddenInputWidget(config){config=$.extend({value:'',name:''},config);OO.ui.HiddenInputWidget.parent.call(this,config);this.$element.attr({type:'hidden',value:config.value,name:config.name});this.$element.removeAttr('aria-disabled')};OO.inheritClass(OO.ui.HiddenInputWidget,OO.ui.Widget);OO.ui.HiddenInputWidget.static.tagName='input';OO.ui.ButtonInputWidget=function OoUiButtonInputWidget(config){config=$.extend({type:'button',useInputTag:!1},config);if(config.$input){config.$input.empty()}
this.useInputTag=config.useInputTag;OO.ui.ButtonInputWidget.parent.call(this,config);OO.ui.mixin.ButtonElement.call(this,$.extend({},config,{$button:this.$input}));OO.ui.mixin.IconElement.call(this,config);OO.ui.mixin.IndicatorElement.call(this,config);OO.ui.mixin.LabelElement.call(this,config);OO.ui.mixin.TitledElement.call(this,$.extend({},config,{$titled:this.$input}));if(!config.useInputTag){this.$input.append(this.$icon,this.$label,this.$indicator)}
this.$element.addClass('oo-ui-buttonInputWidget')};OO.inheritClass(OO.ui.ButtonInputWidget,OO.ui.InputWidget);OO.mixinClass(OO.ui.ButtonInputWidget,OO.ui.mixin.ButtonElement);OO.mixinClass(OO.ui.ButtonInputWidget,OO.ui.mixin.IconElement);OO.mixinClass(OO.ui.ButtonInputWidget,OO.ui.mixin.IndicatorElement);OO.mixinClass(OO.ui.ButtonInputWidget,OO.ui.mixin.LabelElement);OO.mixinClass(OO.ui.ButtonInputWidget,OO.ui.mixin.TitledElement);OO.ui.ButtonInputWidget.static.tagName='span';OO.ui.ButtonInputWidget.prototype.getInputElement=function(config){var type;type=['button','submit','reset'].indexOf(config.type)!==-1?config.type:'button';return $('<'+(config.useInputTag?'input':'button')+' type="'+type+'">')};OO.ui.ButtonInputWidget.prototype.setLabel=function(label){if(typeof label==='function'){label=OO.ui.resolveMsg(label)}
if(this.useInputTag){if(typeof label!=='string'){label=''}
this.$input.val(label)}
return OO.ui.mixin.LabelElement.prototype.setLabel.call(this,label)};OO.ui.ButtonInputWidget.prototype.setValue=function(value){if(!this.useInputTag){OO.ui.ButtonInputWidget.parent.prototype.setValue.call(this,value)}
return this};OO.ui.ButtonInputWidget.prototype.getInputId=function(){return null};OO.ui.CheckboxInputWidget=function OoUiCheckboxInputWidget(config){config=config||{};OO.ui.CheckboxInputWidget.parent.call(this,config);this.$element.addClass('oo-ui-checkboxInputWidget').append($('<span>'));this.setSelected(config.selected!==undefined?config.selected:!1)};OO.inheritClass(OO.ui.CheckboxInputWidget,OO.ui.InputWidget);OO.ui.CheckboxInputWidget.static.tagName='span';OO.ui.CheckboxInputWidget.static.gatherPreInfuseState=function(node,config){var state=OO.ui.CheckboxInputWidget.parent.static.gatherPreInfuseState(node,config);state.checked=config.$input.prop('checked');return state};OO.ui.CheckboxInputWidget.prototype.getInputElement=function(){return $('<input>').attr('type','checkbox')};OO.ui.CheckboxInputWidget.prototype.onEdit=function(){var widget=this;if(!this.isDisabled()){setTimeout(function(){widget.setSelected(widget.$input.prop('checked'))})}};OO.ui.CheckboxInputWidget.prototype.setSelected=function(state){state=!!state;if(this.selected!==state){this.selected=state;this.$input.prop('checked',this.selected);this.emit('change',this.selected)}
if(this.defaultSelected===undefined){this.defaultSelected=this.selected;this.$input[0].defaultChecked=this.defaultSelected}
return this};OO.ui.CheckboxInputWidget.prototype.isSelected=function(){var selected=this.$input.prop('checked');if(this.selected!==selected){this.setSelected(selected)}
return this.selected};OO.ui.CheckboxInputWidget.prototype.simulateLabelClick=function(){if(!this.isDisabled()){this.$input.click()}
this.focus()};OO.ui.CheckboxInputWidget.prototype.restorePreInfuseState=function(state){OO.ui.CheckboxInputWidget.parent.prototype.restorePreInfuseState.call(this,state);if(state.checked!==undefined&&state.checked!==this.isSelected()){this.setSelected(state.checked)}};OO.ui.DropdownInputWidget=function OoUiDropdownInputWidget(config){config=config||{};this.dropdownWidget=new OO.ui.DropdownWidget(config.dropdown);this.setOptionsData(config.options||[]);OO.ui.DropdownInputWidget.parent.call(this,config);this.dropdownWidget.getMenu().connect(this,{select:'onMenuSelect'});this.$element.addClass('oo-ui-dropdownInputWidget').append(this.dropdownWidget.$element);this.setTabIndexedElement(null)};OO.inheritClass(OO.ui.DropdownInputWidget,OO.ui.InputWidget);OO.ui.DropdownInputWidget.prototype.getInputElement=function(){return $('<select>')};OO.ui.DropdownInputWidget.prototype.onMenuSelect=function(item){this.setValue(item?item.getData():'')};OO.ui.DropdownInputWidget.prototype.setValue=function(value){var selected;value=this.cleanUpValue(value);selected=this.dropdownWidget.getMenu().findItemFromData(value)||this.dropdownWidget.getMenu().findFirstSelectableItem();this.dropdownWidget.getMenu().selectItem(selected);value=selected?selected.getData():'';OO.ui.DropdownInputWidget.parent.prototype.setValue.call(this,value);if(this.optionsDirty){this.updateOptionsInterface()}
return this};OO.ui.DropdownInputWidget.prototype.setDisabled=function(state){this.dropdownWidget.setDisabled(state);OO.ui.DropdownInputWidget.parent.prototype.setDisabled.call(this,state);return this};OO.ui.DropdownInputWidget.prototype.setOptions=function(options){var value=this.getValue();this.setOptionsData(options);this.setValue(value);return this};OO.ui.DropdownInputWidget.prototype.setOptionsData=function(options){var
optionWidgets,widget=this;this.optionsDirty=!0;optionWidgets=options.map(function(opt){var optValue,optionWidget;if(opt.optgroup===undefined){optValue=widget.cleanUpValue(opt.data);optionWidget=new OO.ui.MenuOptionWidget({data:optValue,label:opt.label!==undefined?opt.label:optValue})}else{optionWidget=new OO.ui.MenuSectionOptionWidget({label:opt.optgroup})}
return optionWidget});this.dropdownWidget.getMenu().clearItems().addItems(optionWidgets)};OO.ui.DropdownInputWidget.prototype.updateOptionsInterface=function(){var
$optionsContainer=this.$input,defaultValue=this.defaultValue,widget=this;this.$input.empty();this.dropdownWidget.getMenu().getItems().forEach(function(optionWidget){var $optionNode;if(!(optionWidget instanceof OO.ui.MenuSectionOptionWidget)){$optionNode=$('<option>').attr('value',optionWidget.getData()).text(optionWidget.getLabel());$optionNode[0].defaultSelected=(optionWidget.getData()===defaultValue);$optionsContainer.append($optionNode)}else{$optionNode=$('<optgroup>').attr('label',optionWidget.getLabel());widget.$input.append($optionNode);$optionsContainer=$optionNode}});this.optionsDirty=!1};OO.ui.DropdownInputWidget.prototype.focus=function(){this.dropdownWidget.focus();return this};OO.ui.DropdownInputWidget.prototype.blur=function(){this.dropdownWidget.blur();return this};OO.ui.RadioInputWidget=function OoUiRadioInputWidget(config){config=config||{};OO.ui.RadioInputWidget.parent.call(this,config);this.$element.addClass('oo-ui-radioInputWidget').append($('<span>'));this.setSelected(config.selected!==undefined?config.selected:!1)};OO.inheritClass(OO.ui.RadioInputWidget,OO.ui.InputWidget);OO.ui.RadioInputWidget.static.tagName='span';OO.ui.RadioInputWidget.static.gatherPreInfuseState=function(node,config){var state=OO.ui.RadioInputWidget.parent.static.gatherPreInfuseState(node,config);state.checked=config.$input.prop('checked');return state};OO.ui.RadioInputWidget.prototype.getInputElement=function(){return $('<input>').attr('type','radio')};OO.ui.RadioInputWidget.prototype.onEdit=function(){};OO.ui.RadioInputWidget.prototype.setSelected=function(state){this.$input.prop('checked',state);if(this.defaultSelected===undefined){this.defaultSelected=state;this.$input[0].defaultChecked=this.defaultSelected}
return this};OO.ui.RadioInputWidget.prototype.isSelected=function(){return this.$input.prop('checked')};OO.ui.RadioInputWidget.prototype.simulateLabelClick=function(){if(!this.isDisabled()){this.$input.click()}
this.focus()};OO.ui.RadioInputWidget.prototype.restorePreInfuseState=function(state){OO.ui.RadioInputWidget.parent.prototype.restorePreInfuseState.call(this,state);if(state.checked!==undefined&&state.checked!==this.isSelected()){this.setSelected(state.checked)}};OO.ui.RadioSelectInputWidget=function OoUiRadioSelectInputWidget(config){config=config||{};this.radioSelectWidget=new OO.ui.RadioSelectWidget();this.setOptionsData(config.options||[]);OO.ui.RadioSelectInputWidget.parent.call(this,config);this.radioSelectWidget.connect(this,{select:'onMenuSelect'});this.$element.addClass('oo-ui-radioSelectInputWidget').append(this.radioSelectWidget.$element);this.setTabIndexedElement(null)};OO.inheritClass(OO.ui.RadioSelectInputWidget,OO.ui.InputWidget);OO.ui.RadioSelectInputWidget.static.gatherPreInfuseState=function(node,config){var state=OO.ui.RadioSelectInputWidget.parent.static.gatherPreInfuseState(node,config);state.value=$(node).find('.oo-ui-radioInputWidget .oo-ui-inputWidget-input:checked').val();return state};OO.ui.RadioSelectInputWidget.static.reusePreInfuseDOM=function(node,config){config=OO.ui.RadioSelectInputWidget.parent.static.reusePreInfuseDOM(node,config);delete config.$input;return config};OO.ui.RadioSelectInputWidget.prototype.getInputElement=function(){return $('<input>').addClass('oo-ui-element-hidden')};OO.ui.RadioSelectInputWidget.prototype.onMenuSelect=function(item){this.setValue(item.getData())};OO.ui.RadioSelectInputWidget.prototype.setValue=function(value){var selected;value=this.cleanUpValue(value);selected=this.radioSelectWidget.findItemFromData(value)||this.radioSelectWidget.findFirstSelectableItem();this.radioSelectWidget.selectItem(selected);value=selected?selected.getData():'';OO.ui.RadioSelectInputWidget.parent.prototype.setValue.call(this,value);return this};OO.ui.RadioSelectInputWidget.prototype.setDisabled=function(state){this.radioSelectWidget.setDisabled(state);OO.ui.RadioSelectInputWidget.parent.prototype.setDisabled.call(this,state);return this};OO.ui.RadioSelectInputWidget.prototype.setOptions=function(options){var value=this.getValue();this.setOptionsData(options);this.setValue(value);return this};OO.ui.RadioSelectInputWidget.prototype.setOptionsData=function(options){var widget=this;this.radioSelectWidget.clearItems().addItems(options.map(function(opt){var optValue=widget.cleanUpValue(opt.data);return new OO.ui.RadioOptionWidget({data:optValue,label:opt.label!==undefined?opt.label:optValue})}))};OO.ui.RadioSelectInputWidget.prototype.focus=function(){this.radioSelectWidget.focus();return this};OO.ui.RadioSelectInputWidget.prototype.blur=function(){this.radioSelectWidget.blur();return this};OO.ui.CheckboxMultiselectInputWidget=function OoUiCheckboxMultiselectInputWidget(config){config=config||{};this.checkboxMultiselectWidget=new OO.ui.CheckboxMultiselectWidget();this.setOptionsData(config.options||[]);OO.ui.CheckboxMultiselectInputWidget.parent.call(this,config);this.inputName=config.name;this.checkboxMultiselectWidget.connect(this,{select:'onCheckboxesSelect'});this.$element.addClass('oo-ui-checkboxMultiselectInputWidget').append(this.checkboxMultiselectWidget.$element);this.$input.detach()};OO.inheritClass(OO.ui.CheckboxMultiselectInputWidget,OO.ui.InputWidget);OO.ui.CheckboxMultiselectInputWidget.static.gatherPreInfuseState=function(node,config){var state=OO.ui.CheckboxMultiselectInputWidget.parent.static.gatherPreInfuseState(node,config);state.value=$(node).find('.oo-ui-checkboxInputWidget .oo-ui-inputWidget-input:checked').toArray().map(function(el){return el.value});return state};OO.ui.CheckboxMultiselectInputWidget.static.reusePreInfuseDOM=function(node,config){config=OO.ui.CheckboxMultiselectInputWidget.parent.static.reusePreInfuseDOM(node,config);delete config.$input;return config};OO.ui.CheckboxMultiselectInputWidget.prototype.getInputElement=function(){return $('<unused>')};OO.ui.CheckboxMultiselectInputWidget.prototype.onCheckboxesSelect=function(){this.setValue(this.checkboxMultiselectWidget.findSelectedItemsData())};OO.ui.CheckboxMultiselectInputWidget.prototype.getValue=function(){var value=this.$element.find('.oo-ui-checkboxInputWidget .oo-ui-inputWidget-input:checked').toArray().map(function(el){return el.value});if(this.value!==value){this.setValue(value)}
return this.value};OO.ui.CheckboxMultiselectInputWidget.prototype.setValue=function(value){value=this.cleanUpValue(value);this.checkboxMultiselectWidget.selectItemsByData(value);OO.ui.CheckboxMultiselectInputWidget.parent.prototype.setValue.call(this,value);if(this.optionsDirty){this.updateOptionsInterface()}
return this};OO.ui.CheckboxMultiselectInputWidget.prototype.cleanUpValue=function(value){var i,singleValue,cleanValue=[];if(!Array.isArray(value)){return cleanValue}
for(i=0;i<value.length;i++){singleValue=OO.ui.CheckboxMultiselectInputWidget.parent.prototype.cleanUpValue.call(this,value[i]);if(!this.checkboxMultiselectWidget.findItemFromData(singleValue)){continue}
cleanValue.push(singleValue)}
return cleanValue};OO.ui.CheckboxMultiselectInputWidget.prototype.setDisabled=function(state){this.checkboxMultiselectWidget.setDisabled(state);OO.ui.CheckboxMultiselectInputWidget.parent.prototype.setDisabled.call(this,state);return this};OO.ui.CheckboxMultiselectInputWidget.prototype.setOptions=function(options){var value=this.getValue();this.setOptionsData(options);this.setValue(value);return this};OO.ui.CheckboxMultiselectInputWidget.prototype.setOptionsData=function(options){var widget=this;this.optionsDirty=!0;this.checkboxMultiselectWidget.clearItems().addItems(options.map(function(opt){var optValue,item,optDisabled;optValue=OO.ui.CheckboxMultiselectInputWidget.parent.prototype.cleanUpValue.call(widget,opt.data);optDisabled=opt.disabled!==undefined?opt.disabled:!1;item=new OO.ui.CheckboxMultioptionWidget({data:optValue,label:opt.label!==undefined?opt.label:optValue,disabled:optDisabled});item.checkbox.$input.attr('name',widget.inputName);item.checkbox.setValue(optValue);return item}))};OO.ui.CheckboxMultiselectInputWidget.prototype.updateOptionsInterface=function(){var defaultValue=this.defaultValue;this.checkboxMultiselectWidget.getItems().forEach(function(item){var isDefault=defaultValue.indexOf(item.getData())!==-1;item.checkbox.defaultSelected=isDefault;item.checkbox.$input[0].defaultChecked=isDefault});this.optionsDirty=!1};OO.ui.CheckboxMultiselectInputWidget.prototype.focus=function(){this.checkboxMultiselectWidget.focus();return this};OO.ui.TextInputWidget=function OoUiTextInputWidget(config){config=$.extend({type:'text',labelPosition:'after'},config);if(config.multiline){OO.ui.warnDeprecation('TextInputWidget: config.multiline is deprecated. Use the MultilineTextInputWidget instead. See T130434.');return new OO.ui.MultilineTextInputWidget(config)}
OO.ui.TextInputWidget.parent.call(this,config);OO.ui.mixin.IconElement.call(this,config);OO.ui.mixin.IndicatorElement.call(this,config);OO.ui.mixin.PendingElement.call(this,$.extend({},config,{$pending:this.$input}));OO.ui.mixin.LabelElement.call(this,config);this.type=this.getSaneType(config);this.readOnly=!1;this.required=!1;this.validate=null;this.styleHeight=null;this.scrollWidth=null;this.setValidation(config.validate);this.setLabelPosition(config.labelPosition);this.$input.on({keypress:this.onKeyPress.bind(this),blur:this.onBlur.bind(this),focus:this.onFocus.bind(this)});this.$icon.on('mousedown',this.onIconMouseDown.bind(this));this.$indicator.on('mousedown',this.onIndicatorMouseDown.bind(this));this.on('labelChange',this.updatePosition.bind(this));this.on('change',OO.ui.debounce(this.onDebouncedChange.bind(this),250));this.$element.addClass('oo-ui-textInputWidget oo-ui-textInputWidget-type-'+this.type).append(this.$icon,this.$indicator);this.setReadOnly(!!config.readOnly);this.setRequired(!!config.required);if(config.placeholder!==undefined){this.$input.attr('placeholder',config.placeholder)}
if(config.maxLength!==undefined){this.$input.attr('maxlength',config.maxLength)}
if(config.autofocus){this.$input.attr('autofocus','autofocus')}
if(config.autocomplete===!1){this.$input.attr('autocomplete','off');$(window).on({beforeunload:function(){this.$input.removeAttr('autocomplete')}.bind(this),pageshow:function(){this.$input.attr('autocomplete','off')}.bind(this)})}
if(config.spellcheck!==undefined){this.$input.attr('spellcheck',config.spellcheck?'true':'false')}
if(this.label){this.isWaitingToBeAttached=!0;this.installParentChangeDetector()}};OO.inheritClass(OO.ui.TextInputWidget,OO.ui.InputWidget);OO.mixinClass(OO.ui.TextInputWidget,OO.ui.mixin.IconElement);OO.mixinClass(OO.ui.TextInputWidget,OO.ui.mixin.IndicatorElement);OO.mixinClass(OO.ui.TextInputWidget,OO.ui.mixin.PendingElement);OO.mixinClass(OO.ui.TextInputWidget,OO.ui.mixin.LabelElement);OO.ui.TextInputWidget.static.validationPatterns={'non-empty':/.+/,integer:/^\d+$/};OO.ui.TextInputWidget.prototype.onIconMouseDown=function(e){if(e.which===OO.ui.MouseButtons.LEFT){this.focus();return!1}};OO.ui.TextInputWidget.prototype.onIndicatorMouseDown=function(e){if(e.which===OO.ui.MouseButtons.LEFT){this.focus();return!1}};OO.ui.TextInputWidget.prototype.onKeyPress=function(e){if(e.which===OO.ui.Keys.ENTER){this.emit('enter',e)}};OO.ui.TextInputWidget.prototype.onBlur=function(){this.setValidityFlag()};OO.ui.TextInputWidget.prototype.onFocus=function(){if(this.isWaitingToBeAttached){this.onElementAttach()}
this.setValidityFlag(!0)};OO.ui.TextInputWidget.prototype.onElementAttach=function(){this.isWaitingToBeAttached=!1;this.valCache=null;this.positionLabel()};OO.ui.TextInputWidget.prototype.onDebouncedChange=function(){this.setValidityFlag()};OO.ui.TextInputWidget.prototype.isReadOnly=function(){return this.readOnly};OO.ui.TextInputWidget.prototype.setReadOnly=function(state){this.readOnly=!!state;this.$input.prop('readOnly',this.readOnly);return this};OO.ui.TextInputWidget.prototype.isRequired=function(){return this.required};OO.ui.TextInputWidget.prototype.setRequired=function(state){this.required=!!state;if(this.required){this.$input.prop('required',!0).attr('aria-required','true');if(this.getIndicator()===null){this.setIndicator('required')}}else{this.$input.prop('required',!1).removeAttr('aria-required');if(this.getIndicator()==='required'){this.setIndicator(null)}}
return this};OO.ui.TextInputWidget.prototype.installParentChangeDetector=function(){var mutationObserver,onRemove,topmostNode,fakeParentNode,MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,widget=this;if(MutationObserver){if(this.isElementAttached()){return}
topmostNode=this.$element[0];while(topmostNode.parentNode){topmostNode=topmostNode.parentNode}
mutationObserver=new MutationObserver(function(mutations){var i,j,removedNodes;for(i=0;i<mutations.length;i++){removedNodes=mutations[i].removedNodes;for(j=0;j<removedNodes.length;j++){if(removedNodes[j]===topmostNode){setTimeout(onRemove,0);return}}}});onRemove=function(){if(widget.isElementAttached()){widget.onElementAttach()}
mutationObserver.disconnect();widget.installParentChangeDetector()};fakeParentNode=$('<div>').append(topmostNode)[0];mutationObserver.observe(fakeParentNode,{childList:!0})}else{this.$element.on('DOMNodeInsertedIntoDocument',this.onElementAttach.bind(this))}};OO.ui.TextInputWidget.prototype.getInputElement=function(config){if(this.getSaneType(config)==='number'){return $('<input>').attr('step','any').attr('type','number')}else{return $('<input>').attr('type',this.getSaneType(config))}};OO.ui.TextInputWidget.prototype.getSaneType=function(config){var allowedTypes=['text','password','email','url','number'];return allowedTypes.indexOf(config.type)!==-1?config.type:'text'};OO.ui.TextInputWidget.prototype.selectRange=function(from,to){var isBackwards,start,end,input=this.$input[0];to=to||from;isBackwards=to<from;start=isBackwards?to:from;end=isBackwards?from:to;this.focus();try{input.setSelectionRange(start,end,isBackwards?'backward':'forward')}catch(e){if(this.getElementDocument().body.contains(input)){throw e}}
return this};OO.ui.TextInputWidget.prototype.getRange=function(){var input=this.$input[0],start=input.selectionStart,end=input.selectionEnd,isBackwards=input.selectionDirection==='backward';return{from:isBackwards?end:start,to:isBackwards?start:end}};OO.ui.TextInputWidget.prototype.getInputLength=function(){return this.$input[0].value.length};OO.ui.TextInputWidget.prototype.select=function(){return this.selectRange(0,this.getInputLength())};OO.ui.TextInputWidget.prototype.moveCursorToStart=function(){return this.selectRange(0)};OO.ui.TextInputWidget.prototype.moveCursorToEnd=function(){return this.selectRange(this.getInputLength())};OO.ui.TextInputWidget.prototype.insertContent=function(content){var start,end,range=this.getRange(),value=this.getValue();start=Math.min(range.from,range.to);end=Math.max(range.from,range.to);this.setValue(value.slice(0,start)+content+value.slice(end));this.selectRange(start+content.length);return this};OO.ui.TextInputWidget.prototype.encapsulateContent=function(pre,post){var start,end,range=this.getRange(),offset=pre.length;start=Math.min(range.from,range.to);end=Math.max(range.from,range.to);this.selectRange(start).insertContent(pre);this.selectRange(offset+end).insertContent(post);this.selectRange(offset+start,offset+end);return this};OO.ui.TextInputWidget.prototype.setValidation=function(validate){if(validate instanceof RegExp||validate instanceof Function){this.validate=validate}else{this.validate=this.constructor.static.validationPatterns[validate]||/.*/}};OO.ui.TextInputWidget.prototype.setValidityFlag=function(isValid){var widget=this,setFlag=function(valid){if(!valid){widget.$input.attr('aria-invalid','true')}else{widget.$input.removeAttr('aria-invalid')}
widget.setFlags({invalid:!valid})};if(isValid!==undefined){setFlag(isValid)}else{this.getValidity().then(function(){setFlag(!0)},function(){setFlag(!1)})}};OO.ui.TextInputWidget.prototype.getValidity=function(){var result;function rejectOrResolve(valid){if(valid){return $.Deferred().resolve().promise()}else{return $.Deferred().reject().promise()}}
if(this.$input[0].checkValidity!==undefined&&this.$input[0].checkValidity()===!1){return rejectOrResolve(!1)}
if(this.validate instanceof Function){result=this.validate(this.getValue());if(result&&$.isFunction(result.promise)){return result.promise().then(function(valid){return rejectOrResolve(valid)})}else{return rejectOrResolve(result)}}else{return rejectOrResolve(this.getValue().match(this.validate))}};OO.ui.TextInputWidget.prototype.setLabelPosition=function(labelPosition){this.labelPosition=labelPosition;if(this.label){this.updatePosition()}
return this};OO.ui.TextInputWidget.prototype.updatePosition=function(){var after=this.labelPosition==='after';this.$element.toggleClass('oo-ui-textInputWidget-labelPosition-after',!!this.label&&after).toggleClass('oo-ui-textInputWidget-labelPosition-before',!!this.label&&!after);this.valCache=null;this.scrollWidth=null;this.positionLabel();return this};OO.ui.TextInputWidget.prototype.positionLabel=function(){var after,rtl,property,newCss;if(this.isWaitingToBeAttached){return this}
newCss={'padding-right':'','padding-left':''};if(this.label){this.$element.append(this.$label)}else{this.$label.detach();this.$input.css(newCss);return}
after=this.labelPosition==='after';rtl=this.$element.css('direction')==='rtl';property=after===rtl?'padding-left':'padding-right';newCss[property]=this.$label.outerWidth(!0)+(after?this.scrollWidth:0);this.$input.css(newCss);return this};OO.ui.SearchInputWidget=function OoUiSearchInputWidget(config){config=$.extend({icon:'search'},config);OO.ui.SearchInputWidget.parent.call(this,config);this.connect(this,{change:'onChange'});this.updateSearchIndicator();this.connect(this,{disable:'onDisable'})};OO.inheritClass(OO.ui.SearchInputWidget,OO.ui.TextInputWidget);OO.ui.SearchInputWidget.prototype.getSaneType=function(){return'search'};OO.ui.SearchInputWidget.prototype.onIndicatorMouseDown=function(e){if(e.which===OO.ui.MouseButtons.LEFT){this.setValue('');this.focus();return!1}};OO.ui.SearchInputWidget.prototype.updateSearchIndicator=function(){if(this.getValue()===''||this.isDisabled()||this.isReadOnly()){this.setIndicator(null)}else{this.setIndicator('clear')}};OO.ui.SearchInputWidget.prototype.onChange=function(){this.updateSearchIndicator()};OO.ui.SearchInputWidget.prototype.onDisable=function(){this.updateSearchIndicator()};OO.ui.SearchInputWidget.prototype.setReadOnly=function(state){OO.ui.SearchInputWidget.parent.prototype.setReadOnly.call(this,state);this.updateSearchIndicator();return this};OO.ui.MultilineTextInputWidget=function OoUiMultilineTextInputWidget(config){config=$.extend({type:'text'},config);config.multiline=!1;OO.ui.MultilineTextInputWidget.parent.call(this,config);this.multiline=!0;this.autosize=!!config.autosize;this.minRows=config.rows!==undefined?config.rows:'';this.maxRows=config.maxRows||Math.max(2*(this.minRows||0),10);if(this.autosize){this.$clone=this.$input.clone().insertAfter(this.$input).attr('aria-hidden','true').addClass('oo-ui-element-hidden')}
this.connect(this,{change:'onChange'});if(this.multiline&&config.rows){this.$input.attr('rows',config.rows)}
if(this.autosize){this.isWaitingToBeAttached=!0;this.installParentChangeDetector()}};OO.inheritClass(OO.ui.MultilineTextInputWidget,OO.ui.TextInputWidget);OO.ui.MultilineTextInputWidget.static.gatherPreInfuseState=function(node,config){var state=OO.ui.MultilineTextInputWidget.parent.static.gatherPreInfuseState(node,config);state.scrollTop=config.$input.scrollTop();return state};OO.ui.MultilineTextInputWidget.prototype.onElementAttach=function(){OO.ui.MultilineTextInputWidget.parent.prototype.onElementAttach.call(this);this.adjustSize()};OO.ui.MultilineTextInputWidget.prototype.onChange=function(){this.adjustSize()};OO.ui.MultilineTextInputWidget.prototype.updatePosition=function(){OO.ui.MultilineTextInputWidget.parent.prototype.updatePosition.call(this);this.adjustSize()};OO.ui.MultilineTextInputWidget.prototype.onKeyPress=function(e){if((e.which===OO.ui.Keys.ENTER&&(e.ctrlKey||e.metaKey))||e.which===10){this.emit('enter',e)}};OO.ui.MultilineTextInputWidget.prototype.adjustSize=function(){var scrollHeight,innerHeight,outerHeight,maxInnerHeight,measurementError,idealHeight,newHeight,scrollWidth,property;if(this.$input.val()!==this.valCache){if(this.autosize){this.$clone.val(this.$input.val()).attr('rows',this.minRows).css('height',0);this.$clone.removeClass('oo-ui-element-hidden');this.valCache=this.$input.val();scrollHeight=this.$clone[0].scrollHeight;this.$clone.css('height','');innerHeight=this.$clone.innerHeight();outerHeight=this.$clone.outerHeight();this.$clone.attr('rows',this.maxRows).css('height','auto').val('');maxInnerHeight=this.$clone.innerHeight();measurementError=maxInnerHeight-this.$clone[0].scrollHeight;idealHeight=Math.min(maxInnerHeight,scrollHeight+measurementError);this.$clone.addClass('oo-ui-element-hidden');newHeight=idealHeight>innerHeight?idealHeight+(outerHeight-innerHeight):'';if(newHeight!==this.styleHeight){this.$input.css('height',newHeight);this.styleHeight=newHeight;this.emit('resize')}}
scrollWidth=this.$input[0].offsetWidth-this.$input[0].clientWidth;if(scrollWidth!==this.scrollWidth){property=this.$element.css('direction')==='rtl'?'left':'right';this.$label.css({right:'',left:''});this.$indicator.css({right:'',left:''});if(scrollWidth){this.$indicator.css(property,scrollWidth);if(this.labelPosition==='after'){this.$label.css(property,scrollWidth)}}
this.scrollWidth=scrollWidth;this.positionLabel()}}
return this};OO.ui.MultilineTextInputWidget.prototype.getInputElement=function(){return $('<textarea>')};OO.ui.MultilineTextInputWidget.prototype.isMultiline=function(){return!!this.multiline};OO.ui.MultilineTextInputWidget.prototype.isAutosizing=function(){return!!this.autosize};OO.ui.MultilineTextInputWidget.prototype.restorePreInfuseState=function(state){OO.ui.MultilineTextInputWidget.parent.prototype.restorePreInfuseState.call(this,state);if(state.scrollTop!==undefined){this.$input.scrollTop(state.scrollTop)}};OO.ui.ComboBoxInputWidget=function OoUiComboBoxInputWidget(config){config=$.extend({autocomplete:!1},config);config.multiline=!1;if(config.$input){config.$input.removeAttr('list')}
OO.ui.ComboBoxInputWidget.parent.call(this,config);this.$overlay=(config.$overlay===!0?OO.ui.getDefaultOverlay():config.$overlay)||this.$element;this.dropdownButton=new OO.ui.ButtonWidget({classes:['oo-ui-comboBoxInputWidget-dropdownButton'],indicator:'down',disabled:this.disabled});this.menu=new OO.ui.MenuSelectWidget($.extend({widget:this,input:this,$floatableContainer:this.$element,disabled:this.isDisabled()},config.menu));this.connect(this,{change:'onInputChange',enter:'onInputEnter'});this.dropdownButton.connect(this,{click:'onDropdownButtonClick'});this.menu.connect(this,{choose:'onMenuChoose',add:'onMenuItemsChange',remove:'onMenuItemsChange',toggle:'onMenuToggle'});this.$input.attr({role:'combobox','aria-owns':this.menu.getElementId(),'aria-autocomplete':'list'});if(config.options!==undefined){this.setOptions(config.options)}
this.$field=$('<div>').addClass('oo-ui-comboBoxInputWidget-field').append(this.$input,this.dropdownButton.$element);this.$element.addClass('oo-ui-comboBoxInputWidget').append(this.$field);this.$overlay.append(this.menu.$element);this.onMenuItemsChange()};OO.inheritClass(OO.ui.ComboBoxInputWidget,OO.ui.TextInputWidget);OO.ui.ComboBoxInputWidget.prototype.getMenu=function(){return this.menu};OO.ui.ComboBoxInputWidget.prototype.getInput=function(){return this};OO.ui.ComboBoxInputWidget.prototype.onInputChange=function(value){var match=this.menu.findItemFromData(value);this.menu.selectItem(match);if(this.menu.findHighlightedItem()){this.menu.highlightItem(match)}
if(!this.isDisabled()){this.menu.toggle(!0)}};OO.ui.ComboBoxInputWidget.prototype.onInputEnter=function(){if(!this.isDisabled()){this.menu.toggle(!1)}};OO.ui.ComboBoxInputWidget.prototype.onDropdownButtonClick=function(){this.menu.toggle();this.focus()};OO.ui.ComboBoxInputWidget.prototype.onMenuChoose=function(item){this.setValue(item.getData())};OO.ui.ComboBoxInputWidget.prototype.onMenuItemsChange=function(){var match=this.menu.findItemFromData(this.getValue());this.menu.selectItem(match);if(this.menu.findHighlightedItem()){this.menu.highlightItem(match)}
this.$element.toggleClass('oo-ui-comboBoxInputWidget-empty',this.menu.isEmpty())};OO.ui.ComboBoxInputWidget.prototype.onMenuToggle=function(isVisible){this.$element.toggleClass('oo-ui-comboBoxInputWidget-open',isVisible)};OO.ui.ComboBoxInputWidget.prototype.setDisabled=function(disabled){OO.ui.ComboBoxInputWidget.parent.prototype.setDisabled.call(this,disabled);if(this.dropdownButton){this.dropdownButton.setDisabled(this.isDisabled())}
if(this.menu){this.menu.setDisabled(this.isDisabled())}
return this};OO.ui.ComboBoxInputWidget.prototype.setOptions=function(options){this.getMenu().clearItems().addItems(options.map(function(opt){return new OO.ui.MenuOptionWidget({data:opt.data,label:opt.label!==undefined?opt.label:opt.data})}));return this};OO.ui.FieldLayout=function OoUiFieldLayout(fieldWidget,config){if(OO.isPlainObject(fieldWidget)&&config===undefined){config=fieldWidget;fieldWidget=config.fieldWidget}
if(fieldWidget===undefined){throw new Error('Widget not found')}
config=$.extend({align:'left'},config);OO.ui.FieldLayout.parent.call(this,config);OO.ui.mixin.LabelElement.call(this,$.extend({},config,{$label:$('<label>')}));OO.ui.mixin.TitledElement.call(this,$.extend({},config,{$titled:this.$label}));this.fieldWidget=fieldWidget;this.errors=[];this.notices=[];this.$field=this.isFieldInline()?$('<span>'):$('<div>');this.$messages=$('<ul>');this.$header=$('<span>');this.$body=$('<div>');this.align=null;if(config.help){this.popupButtonWidget=new OO.ui.PopupButtonWidget({$overlay:config.$overlay,popup:{padded:!0},classes:['oo-ui-fieldLayout-help'],framed:!1,icon:'info'});if(config.help instanceof OO.ui.HtmlSnippet){this.popupButtonWidget.getPopup().$body.html(config.help.toString())}else{this.popupButtonWidget.getPopup().$body.text(config.help)}
this.$help=this.popupButtonWidget.$element}else{this.$help=$([])}
this.fieldWidget.connect(this,{disable:'onFieldDisable'});if(config.help){(this.fieldWidget.$input||this.fieldWidget.$button||this.fieldWidget.$element).attr('aria-describedby',this.popupButtonWidget.getPopup().getBodyId())}
if(this.fieldWidget.getInputId()){this.$label.attr('for',this.fieldWidget.getInputId())}else{this.$label.on('click',function(){this.fieldWidget.simulateLabelClick()}.bind(this))}
this.$element.addClass('oo-ui-fieldLayout').toggleClass('oo-ui-fieldLayout-disabled',this.fieldWidget.isDisabled()).append(this.$body);this.$body.addClass('oo-ui-fieldLayout-body');this.$header.addClass('oo-ui-fieldLayout-header');this.$messages.addClass('oo-ui-fieldLayout-messages');this.$field.addClass('oo-ui-fieldLayout-field').append(this.fieldWidget.$element);this.setErrors(config.errors||[]);this.setNotices(config.notices||[]);this.setAlignment(config.align);this.updateTitle()};OO.inheritClass(OO.ui.FieldLayout,OO.ui.Layout);OO.mixinClass(OO.ui.FieldLayout,OO.ui.mixin.LabelElement);OO.mixinClass(OO.ui.FieldLayout,OO.ui.mixin.TitledElement);OO.ui.FieldLayout.prototype.onFieldDisable=function(value){this.$element.toggleClass('oo-ui-fieldLayout-disabled',value)};OO.ui.FieldLayout.prototype.getField=function(){return this.fieldWidget};OO.ui.FieldLayout.prototype.isFieldInline=function(){return this.getField().$element.prop('tagName').toLowerCase()==='span'};OO.ui.FieldLayout.prototype.makeMessage=function(kind,text){var $listItem,$icon,message;$listItem=$('<li>');if(kind==='error'){$icon=new OO.ui.IconWidget({icon:'alert',flags:['warning']}).$element;$listItem.attr('role','alert')}else if(kind==='notice'){$icon=new OO.ui.IconWidget({icon:'info'}).$element}else{$icon=''}
message=new OO.ui.LabelWidget({label:text});$listItem.append($icon,message.$element).addClass('oo-ui-fieldLayout-messages-'+kind);return $listItem};OO.ui.FieldLayout.prototype.setAlignment=function(value){if(value!==this.align){if(['left','right','top','inline'].indexOf(value)===-1){value='left'}
if(value==='inline'&&!this.isFieldInline()){value='top'}
if(value==='top'){this.$header.append(this.$help,this.$label);this.$body.append(this.$header,this.$field)}else if(value==='inline'){this.$header.append(this.$help,this.$label);this.$body.append(this.$field,this.$header)}else{this.$header.append(this.$label);this.$body.append(this.$header,this.$help,this.$field)}
if(this.align){this.$element.removeClass('oo-ui-fieldLayout-align-'+this.align)}
this.$element.addClass('oo-ui-fieldLayout-align-'+value);this.align=value}
return this};OO.ui.FieldLayout.prototype.setErrors=function(errors){this.errors=errors.slice();this.updateMessages();return this};OO.ui.FieldLayout.prototype.setNotices=function(notices){this.notices=notices.slice();this.updateMessages();return this};OO.ui.FieldLayout.prototype.updateMessages=function(){var i;this.$messages.empty();if(this.errors.length||this.notices.length){this.$body.after(this.$messages)}else{this.$messages.remove();return}
for(i=0;i<this.notices.length;i++){this.$messages.append(this.makeMessage('notice',this.notices[i]))}
for(i=0;i<this.errors.length;i++){this.$messages.append(this.makeMessage('error',this.errors[i]))}};OO.ui.FieldLayout.prototype.formatTitleWithAccessKey=function(title){if(this.fieldWidget&&this.fieldWidget.formatTitleWithAccessKey){return this.fieldWidget.formatTitleWithAccessKey(title)}
return title};OO.ui.ActionFieldLayout=function OoUiActionFieldLayout(fieldWidget,buttonWidget,config){if(OO.isPlainObject(fieldWidget)&&config===undefined){config=fieldWidget;fieldWidget=config.fieldWidget;buttonWidget=config.buttonWidget}
OO.ui.ActionFieldLayout.parent.call(this,fieldWidget,config);this.buttonWidget=buttonWidget;this.$button=$('<span>');this.$input=this.isFieldInline()?$('<span>'):$('<div>');this.$element.addClass('oo-ui-actionFieldLayout');this.$button.addClass('oo-ui-actionFieldLayout-button').append(this.buttonWidget.$element);this.$input.addClass('oo-ui-actionFieldLayout-input').append(this.fieldWidget.$element);this.$field.append(this.$input,this.$button)};OO.inheritClass(OO.ui.ActionFieldLayout,OO.ui.FieldLayout);OO.ui.FieldsetLayout=function OoUiFieldsetLayout(config){config=config||{};OO.ui.FieldsetLayout.parent.call(this,config);OO.ui.mixin.IconElement.call(this,config);OO.ui.mixin.LabelElement.call(this,config);OO.ui.mixin.GroupElement.call(this,config);this.$header=$('<legend>');if(config.help){this.popupButtonWidget=new OO.ui.PopupButtonWidget({$overlay:config.$overlay,popup:{padded:!0},classes:['oo-ui-fieldsetLayout-help'],framed:!1,icon:'info'});if(config.help instanceof OO.ui.HtmlSnippet){this.popupButtonWidget.getPopup().$body.html(config.help.toString())}else{this.popupButtonWidget.getPopup().$body.text(config.help)}
this.$help=this.popupButtonWidget.$element}else{this.$help=$([])}
this.$header.addClass('oo-ui-fieldsetLayout-header').append(this.$icon,this.$label,this.$help);this.$group.addClass('oo-ui-fieldsetLayout-group');this.$element.addClass('oo-ui-fieldsetLayout').prepend(this.$header,this.$group);if(Array.isArray(config.items)){this.addItems(config.items)}};OO.inheritClass(OO.ui.FieldsetLayout,OO.ui.Layout);OO.mixinClass(OO.ui.FieldsetLayout,OO.ui.mixin.IconElement);OO.mixinClass(OO.ui.FieldsetLayout,OO.ui.mixin.LabelElement);OO.mixinClass(OO.ui.FieldsetLayout,OO.ui.mixin.GroupElement);OO.ui.FieldsetLayout.static.tagName='fieldset';OO.ui.FormLayout=function OoUiFormLayout(config){var action;config=config||{};OO.ui.FormLayout.parent.call(this,config);OO.ui.mixin.GroupElement.call(this,$.extend({},config,{$group:this.$element}));this.$element.on('submit',this.onFormSubmit.bind(this));action=config.action;if(action!==undefined&&!OO.ui.isSafeUrl(action)){action='./'+action}
this.$element.addClass('oo-ui-formLayout').attr({method:config.method,action:action,enctype:config.enctype});if(Array.isArray(config.items)){this.addItems(config.items)}};OO.inheritClass(OO.ui.FormLayout,OO.ui.Layout);OO.mixinClass(OO.ui.FormLayout,OO.ui.mixin.GroupElement);OO.ui.FormLayout.static.tagName='form';OO.ui.FormLayout.prototype.onFormSubmit=function(){if(this.emit('submit')){return!1}};OO.ui.PanelLayout=function OoUiPanelLayout(config){config=$.extend({scrollable:!1,padded:!1,expanded:!0,framed:!1},config);OO.ui.PanelLayout.parent.call(this,config);this.$element.addClass('oo-ui-panelLayout');if(config.scrollable){this.$element.addClass('oo-ui-panelLayout-scrollable')}
if(config.padded){this.$element.addClass('oo-ui-panelLayout-padded')}
if(config.expanded){this.$element.addClass('oo-ui-panelLayout-expanded')}
if(config.framed){this.$element.addClass('oo-ui-panelLayout-framed')}};OO.inheritClass(OO.ui.PanelLayout,OO.ui.Layout);OO.ui.PanelLayout.prototype.focus=function(){OO.ui.findFocusable(this.$element).focus()};OO.ui.HorizontalLayout=function OoUiHorizontalLayout(config){config=config||{};OO.ui.HorizontalLayout.parent.call(this,config);OO.ui.mixin.GroupElement.call(this,$.extend({},config,{$group:this.$element}));this.$element.addClass('oo-ui-horizontalLayout');if(Array.isArray(config.items)){this.addItems(config.items)}};OO.inheritClass(OO.ui.HorizontalLayout,OO.ui.Layout);OO.mixinClass(OO.ui.HorizontalLayout,OO.ui.mixin.GroupElement)}(OO))